<HTML>
<HEAD>
<BASE target="_top">
<TITLE>United States Patent: 7356585</TITLE></HEAD>
<!-BUF1=7356585
BUF7=2008
BUF8=94047
BUF9=/1/
BUF51=7
-->
<BODY bgcolor="#FFFFFF">
<A name="top"></A>
<CENTER>
<IMG src="/netaicon/PTO/patfthdr.gif" alt="[US Patent & Trademark Office, Patent Full Text and Image Database]">
<BR>
<TABLE>
<TR><TD align="center">
<A href="/netahtml/PTO/index.html"><IMG src="/netaicon/PTO/home.gif" alt="[Home]" border="0" valign="middle"></A>
<A href="/netahtml/PTO/search-bool.html"><IMG src="/netaicon/PTO/boolean.gif" alt="[Boolean Search]" border="0" valign="middle"></A>
<A href="/netahtml/PTO/search-adv.htm"><IMG border="0" src="/netaicon/PTO/manual.gif" ALT="[Manual Search]" valign="middle"></A>
<A href="/netahtml/PTO/srchnum.htm"><IMG src="/netaicon/PTO/number.gif" alt="[Number Search]" border="0" valign="middle"></A>
<A href="/netahtml/PTO/help/help.htm"><IMG border="0" valign="middle" src="/netaicon/PTO/help.gif" ALT="[Help]"></A>
</TD></TR>
<TR><TD align="center">
   <A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=967&f=S&l=50&d=PTXT&s1=((G06F.CPCL.+AND+(%22intrusion+prevention+system%22+OR+%22intrusion+detection+system%22))+AND+((power+OR+electricity)+OR+relay))&p=19&Query=CPCL/G06F+AND+(&quot;intrusion+prevention+system&quot;+OR+&quot;intrusion+detection+system&quot;)+AND+(power+or+electricity+or+relay)><IMG VALIGN=MIDDLE SRC=/netaicon/PTO/prevlist.gif border=0 ALT=[PREV_LIST]></A>
<A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=967&f=S&l=50&d=PTXT&s1=((G06F.CPCL.+AND+(%22intrusion+prevention+system%22+OR+%22intrusion+detection+system%22))+AND+((power+OR+electricity)+OR+relay))&p=20&Query=CPCL/G06F+AND+(&quot;intrusion+prevention+system&quot;+OR+&quot;intrusion+detection+system&quot;)+AND+(power+or+electricity+or+relay)><IMG VALIGN=MIDDLE SRC=/netaicon/PTO/hitlist.gif border=0 ALT=[HIT_LIST]></A>
<A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=967&f=S&l=50&d=PTXT&s1=((G06F.CPCL.+AND+(%22intrusion+prevention+system%22+OR+%22intrusion+detection+system%22))+AND+((power+OR+electricity)+OR+relay))&p=21&Query=CPCL/G06F+AND+(&quot;intrusion+prevention+system&quot;+OR+&quot;intrusion+detection+system&quot;)+AND+(power+or+electricity+or+relay)><IMG VALIGN=MIDDLE SRC=/netaicon/PTO/nextlist.gif border=0 ALT=[NEXT_LIST]></A>
<A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=966&f=G&l=50&d=PTXT&s1=((G06F.CPCL.+AND+(%22intrusion+prevention+system%22+OR+%22intrusion+detection+system%22))+AND+((power+OR+electricity)+OR+relay))&p=20&OS=CPCL/G06F+AND+(&quot;intrusion+prevention+system&quot;+OR+&quot;intrusion+detection+system&quot;)+AND+(power+or+electricity+or+relay)><IMG VALIGN=MIDDLE SRC=/netaicon/PTO/prevdoc.gif border=0 ALT=[PREV_DOC]></A>
<A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=968&f=G&l=50&d=PTXT&s1=((G06F.CPCL.+AND+(%22intrusion+prevention+system%22+OR+%22intrusion+detection+system%22))+AND+((power+OR+electricity)+OR+relay))&p=20&OS=CPCL/G06F+AND+(&quot;intrusion+prevention+system&quot;+OR+&quot;intrusion+detection+system&quot;)+AND+(power+or+electricity+or+relay)><IMG VALIGN=MIDDLE SRC=/netaicon/PTO/nextdoc.gif border=0 ALT=[NEXT_DOC]></A>

<A href="#bottom"><IMG src="/netaicon/PTO/bottom.gif" alt="[Bottom]" valign="middle" border="0"></A>
</TD></TR>
   <TR><TD align="center">
   <A href="https://certifiedcopycenter.uspto.gov/other/patft/view.html?backUrl1=http%3A//patft.uspto.gov/netacgi/nph-Parser?Sect1%3DPTO2%26Sect2%3DHITOFF%26u%3D%25252Fnetahtml%25252FPTO%25252Fsearch-adv.htm%26r%3D967%26f%3DG%26l%3D50%26d%3DPTXT%26s1%3D((G06F.CPCL.%252BAND%252B(%252522intrusion%252Bprevention%252Bsystem%252522%252BOR%252B%252522intrusion%252Bdetection%252Bsystem%252522))%252BAND%252B((power%252BOR%252Belectricity)%252BOR%252Brelay))%26p%3D20%26OS%3DCPCL%2FG06F%252BAND%252B(%252522intrusion%252Bprevention%252Bsystem%252522%252BOR%252B%252522intrusion%252Bdetection%252Bsystem%252522)%252BAND%252B(power%252Bor%252Belectricity%252Bor%252Brelay)&backLabel1=Back%20to%20Document%3A%207356585"><IMG border="0" src="/netaicon/PTO/cart.gif" border="0" valign="middle" alt="[View Shopp
ing Cart]"></A>
   <A href="https://certifiedcopycenter.uspto.gov/other/patft/order.html?docNumber=7356585&backUrl1=http%3A//patft.uspto.gov/netacgi/nph-Parser?Sect1%3DPTO2%26Sect2%3DHITOFF%26u%3D%25252Fnetahtml%25252FPTO%25252Fsearch-adv.htm%26r%3D967%26f%3DG%26l%3D50%26d%3DPTXT%26s1%3D((G06F.CPCL.%252BAND%252B(%252522intrusion%252Bprevention%252Bsystem%252522%252BOR%252B%252522intrusion%252Bdetection%252Bsystem%252522))%252BAND%252B((power%252BOR%252Belectricity)%252BOR%252Brelay))%26p%3D20%26OS%3DCPCL%2FG06F%252BAND%252B(%252522intrusion%252Bprevention%252Bsystem%252522%252BOR%252B%252522intrusion%252Bdetection%252Bsystem%252522)%252BAND%252B(power%252Bor%252Belectricity%252Bor%252Brelay)&backLabel1=Back%20to%20Document%3A%207356585">
   <IMG border="0" src="/netaicon/PTO/order.gif" valign="middle" alt="[Add to Shopping Cart]"></A>
   </TD></TR>
   <TR><TD align="center">
   <a href=http://pdfpiw.uspto.gov/.piw?Docid=07356585&homeurl=http%3A%2F%2Fpatft.uspto.gov%2Fnetacgi%2Fnph-Parser%3FSect1%3DPTO2%2526Sect2%3DHITOFF%2526u%3D%25252Fnetahtml%25252FPTO%25252Fsearch-adv.htm%2526r%3D967%2526f%3DG%2526l%3D50%2526d%3DPTXT%2526s1%3D((G06F.CPCL.%252BAND%252B(%252522intrusion%252Bprevention%252Bsystem%252522%252BOR%252B%252522intrusion%252Bdetection%252Bsystem%252522))%252BAND%252B((power%252BOR%252Belectricity)%252BOR%252Brelay))%2526p%3D20%2526OS%3DCPCL%2FG06F%252BAND%252B(%252522intrusion%252Bprevention%252Bsystem%252522%252BOR%252B%252522intrusion%252Bdetection%252Bsystem%252522)%252BAND%252B(power%252Bor%252Belectricity%252Bor%252Brelay)%2526RS%3D((CPCL%2FG06F%252BAND%252B(%252522intrusion%252Bprevention%252Bsystem%252522%252BOR%252B%252522intrusion%252Bdetection%252Bsystem%252522))%252BAND%252B((power%252BOR%252Belectricity)%252BOR%252Brelay))&PageNum=&Rtype=&SectionNum=&idkey=NONE&Input=View+first+page><img src="/netaicon/PTO/image.gif" alt="[Image]" border="0" valign="middle"></A>

   </TD></TR>
</TABLE>
</CENTER>
<TABLE width="100%">
<TR><TD align="left" width="50%">&nbsp;</TD>
<TD align="right" valign="bottom" width="50%"><FONT size="-1">( <STRONG>967</STRONG></FONT> <FONT size=-2>of</FONT> <STRONG><FONT size=-1>1029</STRONG> )</FONT></TD></TR></TABLE>
<HR>
   <TABLE width="100%">
   <TR>	<TD align="left" width="50%"><b>United States Patent </b></TD>
   <TD align="right" width="50%"><b>7,356,585</b></TD>
   </TR>
     <TR><TD align="left" width="50%"><b>
         Brook
, &nbsp; et al.</b>
     </TD>
     <TD align="right" width="50%"> <b>
     April 8, 2008
</b></TD>
     </TR>
     </TABLE>
       <TABLE width="100%">
       <TR>
       <TD align="center" width="100%"><FONT size="-2"><b>**Please see images for: </b>
         <FONT size="-2"><b>( Certificate of Correction ) </b>
       <FONT size="-2"><b> **</b>
       </TD>
       </TR>
       </TABLE>
       <HR>
       <FONT size="+1">Vertically extensible <B><I>intrusion detection system</I></B> and method
</FONT><BR>
       <BR><CENTER><b>Abstract</b></CENTER>
       <p> A method for vertically extensible intrusion detection for an enterprise
     comprises receiving a first packet flow from a first node, the first
     packet flow comprising at least a portion of packet headers received at
     the first node during a first timeframe and receiving a second packet
     flow, the second packet flow comprising at least a portion of packet
     headers received at the second node during a second timeframe. The first
     and second packet flow are processed to detect an attack on the
     enterprise system. In response to the attack, an alert message is
     communicated to a master server, a response message is received from the
     master server, the response message comprising a signature to impede the
     attack, and the response message is automatically communicated to the
     first node and the second node.
</p>
       <HR>
<TABLE width="100%"> <TR> <TH scope="row" valign="top" align="left" width="10%">Inventors:</TH> <TD align="left" width="90%">
 <B>Brook; Jon-Michael C.</B> (Clearwater, FL)<B>, Rixon; Matthew C.</B> (Sarasota, FL)<B>, Brooks; Randall S.</B> (Tampa, FL)<B>, Rockwood; Troy Dean</B> (Thousand Oaks, CA) </TD> </TR>
<TR> <TH scope="row" valign="top" align="left" width="10%">Assignee:</TH>
<TD align="left" width="90%">

<B>Raytheon Company</B>
 (Waltham, 
MA)
<BR>

</TD>
</TR>
       <TR><TH scope="row" valign="top" align="left" width="10%" nowrap>Family ID:
       </TD><TD align="left" width="90%">
       <b>39263594
</b></TD></TR>
       <TR><TH scope="row" valign="top" align="left" width="10%" nowrap>Appl. No.:
       </TH><TD align="left" width="90%">
       <b>10/407,513</b></TD></TR>
       <TR><TH scope="row" valign="top" align="left" width="10%">Filed:
       </TH><TD align="left" width="90%">
       <b>April 4, 2003</b></TD></TR>
     </TABLE>
     <HR>
<p> <TABLE width="100%"> <TR><TD valign="top" align="left" width="30%"><b>Current U.S. Class:</b></TD> <TD valign="top" align="right" width="70%"><b>709/224</b>; 709/225; 709/227; 709/236; 709/246 </TD></TR> 
       <TR><TD valign="top" align="left" width="30%"><b>Current CPC Class: </b></TD>
       <TD valign="top" align="right" width="70%">H04L 63/1416&nbsp(20130101); G06F 2221/2101&nbsp(20130101); H04L 63/0227&nbsp(20130101)</TD></TR>
         <TR><TD valign="top" align="left" width="30%"><b>Current International Class: </b></TD>
         <TD valign="top" align="right" width="70%">G06F 15/16&nbsp(20060101); G06F 15/173&nbsp(20060101)</TD></TR>
       <TR><TD valign="top" align="left" width="30%"><b>Field of Search: </b></TD>
       <TD align="right" valign="top" width="70%">
       







 ;709/223,224,227,246,225,236 ;718/105 ;713/201
       </TD></TR>
     </TABLE>
<HR><CENTER><b>References Cited  <A href="/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2Fsearch-adv.htm&r=0&f=S&l=50&d=PALL&Query=ref/7356585">[Referenced By]</A></b></CENTER>       <HR>
       <CENTER><b>U.S. Patent Documents</b></CENTER>
<TABLE width="100%"> <TR><TH scope="col" width="33%"></TH> <TH scope="col" width="33%"></TH> <TH scope="col" width="34%"></TH></TR> <TR> <TD align="left">
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F5020411">5020411</a></TD><TD align =left>
June 1991</TD><TD align=left>
Rowan</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F5341229">5341229</a></TD><TD align =left>
August 1994</TD><TD align=left>
Rowan</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F5991881">5991881</a></TD><TD align =left>
November 1999</TD><TD align=left>
Conklin et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F6226589">6226589</a></TD><TD align =left>
May 2001</TD><TD align=left>
Maeda et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F6404380">6404380</a></TD><TD align =left>
June 2002</TD><TD align=left>
Poore, Jr.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F6744396">6744396</a></TD><TD align =left>
June 2004</TD><TD align=left>
Stone et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F6954775">6954775</a></TD><TD align =left>
October 2005</TD><TD align=left>
Shanklin et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7058976">7058976</a></TD><TD align =left>
June 2006</TD><TD align=left>
Dark</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7127743">7127743</a></TD><TD align =left>
October 2006</TD><TD align=left>
Khanolkar et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7130611">7130611</a></TD><TD align =left>
October 2006</TD><TD align=left>
Kimura et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7146421">7146421</a></TD><TD align =left>
December 2006</TD><TD align=left>
Syvanne</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7185368">7185368</a></TD><TD align =left>
February 2007</TD><TD align=left>
Copeland, III</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20020112189&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2002/0112189</a></TD><TD align =left>
August 2002</TD><TD align=left>
Syvanne et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20030105976&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2003/0105976</a></TD><TD align =left>
June 2003</TD><TD align=left>
Copeland, III</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20030145226&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2003/0145226</a></TD><TD align =left>
July 2003</TD><TD align=left>
Bruton et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20030154399&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2003/0154399</a></TD><TD align =left>
August 2003</TD><TD align=left>
Zuk et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20030177383&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2003/0177383</a></TD><TD align =left>
September 2003</TD><TD align=left>
Ofek et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20040015719&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2004/0015719</a></TD><TD align =left>
January 2004</TD><TD align=left>
Lee et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20040024855&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2004/0024855</a></TD><TD align =left>
February 2004</TD><TD align=left>
Tsai et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20040103211&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2004/0103211</a></TD><TD align =left>
May 2004</TD><TD align=left>
Jackson et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20040172557&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2004/0172557</a></TD><TD align =left>
September 2004</TD><TD align=left>
Nakae et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20040193943&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2004/0193943</a></TD><TD align =left>
September 2004</TD><TD align=left>
Angelino et al.</TD></TR><TR><TD align=left>

</TD>
</TR> </TABLE>
<TABLE width="90%"> <BR> <CENTER><b>Other References</b></CENTER> <TR><TD><align="left"><BR>A Arnold, "Kernel Based Anomaly Detection," Intrusion Detection Systems, Machine Learning Group, Columbia University, 2 pages, Apr. 26, 2001. cited by
other
.<BR>R. Bace and P. Mell, "NIST Special Publication on Intrusion Detection Systems," 51 pages, Feb. 2001. cited by other
.<BR>C. Boeckman, "Getting Closer to Policy-Based Intrusion Detection." Information Security Bulletin, pp. 13-20, May 2000. cited by other
.<BR>Cisco Systems, Inc., "NetRanger User Guide 2.2.1," Chapters 1-9 and Appendices A-C, 2000. cited by other
.<BR>Commonwealth of Australia, "Handbook 13, Intrusion Detection and Audit Analysis v. 1.0," Australian Communications-Electronic Security Instruction 33 (ACSI 33). cited by other
.<BR>D. Curry, and H. Debar, "Intrusion Detection Message Exchange Format Data Model and Extensible Markup Language (XML) Document Type Definition," Intrusion Detection Working Group, 116 pages, Jan. 2003. cited by other
.<BR>W. Jansen, P. Mell, et al., "Mobile Agents in Intrusion Detection and Response." National Institute for Standards and Technology, 12 pages, Jun. 2000. cited by other
.<BR>Symantec, "Intrusion Detection," 4 pages, 2002. cited by other
.<BR>Intrusion.com, Inc., "Network <A Name=h2 HREF=#h1></A><A  HREF=#h3></A><B><I>Intrusion Detection System</I></B> Product Overview," SecureNet Series, 6 pages, Jul. 2001. cited by other
.<BR>Phung, "Data Mining in Intrusion Detection," Sans.org, 3 pages, Jan. 24, 2000. cited by other
.<BR>R. <A Name=h3 HREF=#h2></A><A  HREF=#h4></A><B><I>Power,</I></B> "CSI Roundtable: Experts discuss present and future intrusion detection systems,." Computer Security Journal vol. XIV, #1, 2001. cited by other
.<BR>R. Raghudharan, "Intrusion Detection Systems: Beyond the first line of defense," Network Magazine, 7 pages, Sep. 2001. cited by other
.<BR>ISS Corporation, "ISS RealSecure .COPYRGT. Protection System," 5 pages, Apr. 1, 2003. cited by other
.<BR>Stick, "A Potential Denial of Service Against IDS Systems," Internet Security Systems Security Alert, 2 pages, Mar. 2001. cited by other
.<BR>S. Northcutt, and J. Novak, "Network Intrusion Detection: An Analyst's Handbook," 2.sup.nd Ed., 18 pages, Sep. 2000. cited by other
.<BR>B. Yocom, K. Brown, and D. Van Derveer, "Intrusion Detection Products Grow Up," Network World, 12 pages, Oct. 2001. cited by other
.<BR>Y.F. Jou, F. Gong, C. Sargor, X Wu, S.F. Wu, H.Y. Chang and F. Wang, "Design and implementation of a scalable <A Name=h4 HREF=#h3></A><A  HREF=#h5></A><B><I>intrusion detection system</I></B> for protection of network infrastructure," DARPA Information Survivability Conference and Exposition (DISCEX),
15 pages, Jan. 2000. cited by other
.<BR>J. Li and G. Eschelbeck, "Multi-Tier <A Name=h5 HREF=#h4></A><A  HREF=#h6></A><B><I>Intrusion Detection System,</I></B>" 11 pages. cited by other
.<BR>F. Wang, F. Gong, C. Sargor, K. Goseva-Popstojanova, K. Trivedi and F. Jou, "SITAR: A Scalable Intrusion-Tolerant Architecture for Distributed Services," IEEE Workshop on Information Assurance and Security, pp. 38-45, Jun. 2001. cited by other
.<BR>S.F. Wu, H.C. Chang, F. Jou, F. Wang, F. Gong, C. Sargor, D. Qu and R. Cleaveland, "JiNao: Design and Implementation of a Scalable <A Name=h6 HREF=#h5></A><A  HREF=#h7></A><B><I>Intrusion Detection System</I></B> for the OSPF Routing Protocol," pp. 0-23, Feb. 24, 1999. cited by other
.<BR>Jiang, "Compressing N-Dimensional Data", inventors Qin Jiang, et al., U.S. Appl. No. 11/559,786, 31 pages, 3 pages of drawings, filed Nov. 14, 2006. cited by other
.<BR>Gersho et al., entitled "Vector Quantization and Signal Compression," Academic Publisher, 737 pages, 1992. cited by other
.<BR>Dasgupta; Experiments with Random Projection; Proc. 16th Conference Uncertainty in Artificial Intelligence (UAI), 9 pages, 2000. cited by other. </TD></TR> </TABLE> <BR>
       <i>Primary Examiner:</i> Nguyen; Quang N.
<BR>
       <i>Attorney, Agent or Firm:</i> <coma>Baker Botts L.L.P.
<BR>
         <HR>
<CENTER><b><i>Claims</b></i></CENTER> <HR> <BR><BR>What is claimed is: <BR><BR> 1.  Software encoded in one or more computer-readable storage media and when executed operable to: receive a first packet flow from a first node, the first packet flow
comprising at least a portion of packet headers received at the first node during a first timeframe;  receive a second packet flow from a second node, the second packet flow comprising at least a portion of packet headers received at the second node
during a second timeframe;  process the first and second packet flows to detect an attack;  associate the first packet flow with the second packet flow to create a third packet flow, the third packet flow comprising the first and second packet flows; 
associate an alert message with the third packet flow;  in response to the attack: communicate the alert message to a master server, wherein the operability of the software to communicate the alert message to the master server comprises the software
being operable to communicate the third packet flow and the associated alert message to the master server;  receive a response message from the master server;  automatically communicate the response message to the first node;  automatically communicate
the response message to the second node;  wherein the response message is operable to impede, at the first node and the second node, the attack;  and wherein the first packet flow received from the first node is associated with a first priority and the
second packet flow received from the second node is associated with a second priority, the software further operable to: compare the first priority and the second priority;  in response to the first priority not being less than the second priority,
assign the first priority to the third packet flow;  and in response to the second priority being greater than the first priority, assign the second priority to the third packet flow.
<BR><BR> 2.  The software of claim 1 further operable to: compute a priority of the third packet flow based, at least in part, on the alert message and on one or more rules;  and assign the computed priority to the third packet flow.
<BR><BR> 3.  The software of claim 2, wherein the operability of the software to communicate the third packet flow and the associated alert message to the master server comprises the software being operable to communicate the third packet flow and the
associated alert message to the master server based on the priority.
<BR><BR> 4.  The software of claim 1, the first timeframe comprising time between a Transmission Control Protocol (TCP) handshake and a TCP reset/timeout.
<BR><BR> 5.  The software of claim 1 further operable to: compute a verification value for the alert message;  and associate the verification value with the alert message to be communicated to the master server.
<BR><BR> 6.  The software of claim 1, wherein the operability of the software to receive a response message from the master server comprises the software being operable to: receive the response message associated with a first verification value;  compute
a second verification value based on the response message;  compare the first and second verification values;  and in response to the first and second verification values not being equal, not communicate the response message to the first node or the
second node.
<BR><BR> 7.  The software of claim 1, wherein the master server comprises a global server, the first node comprises a first manager server and the second node comprises a second manager server.
<BR><BR> 8.  The intrusion detection software of claim 7, wherein the global server comprises a global correlation engine and an archive database, the global correlation engine operable to automatically process the archive database to detect a long-term
attack.
<BR><BR> 9.  The software of claim 1 further operable to: receive first archival data from the first node, the first archival data comprising the full packet information associated with the first message;  and receive second archival data from the second
node, the second archival data comprising substantially all of the packet information associated with the second message.
<BR><BR> 10.  The software of claim 9 further operable to: combine the first and second archival data into third archival data;  and communicate the third archival data to the master server.
<BR><BR> 11.  The software of claim 1, wherein the software is operable to process the first and second packet flows at a speed substantially similar to a maximum processing speed between the first node and the second node.
<BR><BR> 12.  A method comprising: receiving a first packet flow from a first node, the first packet flow comprising at least a portion of packet headers received at the first node during a first timeframe;  receiving a second packet flow from a second
node, the second packet flow comprising at least a portion of packet headers received at the second node during a second timeframe;  processing the first and second packet flows to detect an attack on an enterprise system;  associating the first packet
flow with the second packet flow to create a third packet flow, the third packet flow comprising the first and second packet flows;  associating an alert message with the third Packet flow;  in response to the attack: communicating the alert message to a
master server, wherein the step of communicating the alert message to the master server comprises communicating the third packet flow and the associated alert message to the master server;  receiving a response message from the master server; 
automatically communicating the response message to the first node;  automatically communicating the response message to the second node;  wherein the response message is operable to impede, at the first node and the second node, the attack;  and wherein
the first packet flow received from the first node is associated with a first priority and the second packet flow received from the second node is associated with a second priority, the method further comprising: comparing the first priority and the
second priority;  in response to the first priority not being less than the second priority, assigning the first priority to the third packet flow;  and in response to the second priority being greater than the first priority, assigning the second
priority to the third packet flow.
<BR><BR> 13.  The method of claim 12 further comprising: computing a priority of the third packet flow based, at least in part, on the alert message and on one or more rules;  and assigning the computed priority to the third packet flow.
<BR><BR> 14.  The method of claim 13 further comprising communicating the third message and the associated alert message to the master server based on the priority.
<BR><BR> 15.  The method of claim 12, the first timeframe comprising time between a Transmission Control Protocol (TCP) handshake and a TCP reset/timeout.
<BR><BR> 16.  The method of claim 12 further comprising: computing a verification value for the alert message;  and associating the verification value with the alert message to be communicated to the master server.
<BR><BR> 17.  The method of claim 12, further comprising: receiving the response message associated with a first verification value;  computing a second verification value based on the response message;  comparing the first and second verification
values;  and in response to the first and second verification values not being equal, not communicating the response message to the first node or the second node.
<BR><BR> 18.  The method of claim 12, wherein the master server comprises a global server, the first node comprises a first manager server and the second node comprises a second manager server.
<BR><BR> 19.  The method of claim 18, wherein the global server comprises a global correlation engine and an archive database, the global correlation engine operable to automatically process the archive database to detect a long-term attack.
<BR><BR> 20.  The method of claim 12 further comprising: receiving first archival data from the first node, the first archival data comprising the full packet data associated with the first message;  and receiving second archival data from the second
node, the second archival data comprising substantially all of the packet data associated with the second message.
<BR><BR> 21.  The method of claim 20 further comprising: combining the first and second archival data into third archival data;  and communicating the third archival data to the master server.
<BR><BR> 22.  The method of claim 12, wherein the first and second messages are processed at a speed substantially similar to a maximum processing speed between the first node and the second node.
<BR><BR> 23.  Logic encoded in one or more tangible storage media for execution and when executed operable to: receive a first message from a first node;  receive a second message from a second node;  process the first and second packet messages to
detect an attack on an enterprise system;  associate the first message with the second message to create a third message, the third message comprising the first and second messages;  associate an alert message with the third message;  in response to the
attack: communicate the alert message to a master server, wherein the operability of the logic to communicate the alert message to the master server comprises the logic being operable to communicate the third message and the associated alert message to
the master server;  receive a response message from the master server;  automatically communicate the response message to the first node;  automatically communicate the response message to the second node;  wherein the response message is operable to
impede, at the first node and the second node, the attack;  and wherein the first message received from the first node is associated with a first priority and the second message received from the second node is associated with a second priority, the
logic further operable to: compare the first priority and the second priority;  in response to the first priority not being less than the second priority, assign the first priority to the third message;  and in response to the second priority being
greater than the first priority, assign the second priority to the third message.
<BR><BR> 24.  The logic of claim 23 further operable to: compute a priority of the third message based, at least in part, on the alert message and on one or more rules;  and assign the computed priority to the third message.
<BR><BR> 25.  The logic of claim 24, wherein the operability of the logic to communicate the third message and the associated alert message to the master server comprises the intrusion detection software being operable to communicate the third message
and the associated alert message to the master server based on the priority.
<BR><BR> 26.  The logic of claim 23 further operable to: compute a verification value for the alert message;  and associate the verification value with the alert message to be communicated to the master server.
<BR><BR> 27.  The logic of claim 23, wherein the operability of the logic to receive a response message from the master server comprises the logic being operable to: receive the response message associated with a first verification value;  compute a
second verification value based on the response message;  compare the first and second verification values;  and in response to the first and second verification values not being equal, not communicate the response message to the first node or the second
node.
<BR><BR> 28.  The logic of claim 23, wherein the master server comprises a global server, the first node comprises a first manager server and the second node comprises a second manger server.
<BR><BR> 29.  The logic of claim 28, wherein the global server comprises a global correlation engine and an archive database, the global correlation engine operable to automatically process the archive database to detect a long-term attack.
<BR><BR> 30.  The logic of claim 23 further operable to: receive first archival data from the first node, the first archival data comprising the full Internet Protocol (IP) data associated with the first message;  and receive second archival data from
the second node, the second archival data comprising substantially all of the IP data associated with the second message.
<BR><BR> 31.  The logic of claim 30 further operable to: combine the first and second archival data into third archival data;  and communicate the third archival data to the master server.
<BR><BR> 32.  The logic of claim 23, wherein the logic is operable to process the first and second messages at a speed substantially similar to a maximum processing speed between the first node and the second node.
<BR><BR> 33.  A system comprising: a first sensor operable to receive data from a first port on a network;  a second sensor operable to receive data from a second port on the network;  and a manager server communicably connected to the first and second
sensors, the manager server operable to: retrieve a first message from the first sensor, the first message comprising binary data for a first timeframe;  retrieve a second message from the second sensor, the second message comprising binary data for a
second timeframe;  communicate the first and second messages to a master server, the master server communicably connected to the manager server;  process the first and second messages to detect an attack on an enterprise system;  associate the first
message with the second message to create a third message, the third message comprising the first and second messages;  associate an alert message with the third message;  in response to the attack, the manager server further operable to communicate the
alert message to the master server, wherein the operability of the manager server to communicate the alert message to the master server comprises the manager server being operable to communicate the third message and the associated alert message to the
master server, receive a response message from the master server, automatically communicate the response message to the first sensor, and automatically communicate the response message to the second sensor, wherein the first sensor and the second sensor
are operable to impede the attack based on the automatically communicated response messages;  and wherein the first message received from the first sensor is associated with a first priority and the second message received from the second sensor is
associated with a second priority, the manager server further operable to: compare the first priority and the second priority;  in response to the first priority not being less than the second priority, assign the first priority to the third message; 
and in response to the second priority being greater than the first priority, assign the second priority to the third message.
<BR><BR> 34.  The system of claim 33, the manager server further operable to: compute a priority of the third message based, at least in part, on the alert message and on one or more rules;  and assign the computed priority to the third message.
<BR><BR> 35.  The system of claim 34, the manager server further operable to communicate the third message and the associated alert message to the master server based on the priority.
<BR><BR> 36.  The system of claim 33, the first timeframe comprising time between a Transmission Control Protocol (TCP) handshake and a TCP reset/timeout.
<BR><BR> 37.  The system of claim 33, the manager server further operable to: compute a verification value for the alert message;  and associate the verification value with the alert message to be communicated to the master server.
<BR><BR> 38.  The system of claim 33, the manager server further operable to: receive the response message associated with a first verification value;  compute a second verification value based on the response message;  compare the first and second
verification values;  and in response to the first and second verification values not being equal, to communicate the response message to the first node or the second node.
<BR><BR> 39.  The system of claim 33, wherein the manager server comprises a first manager server and the master server comprises a first master server, the system further comprising: a second master server, the second master server communicably
connected to at least one second manager server, the second manager server communicably connected to at least a third and fourth sensor;  a global server, the global server communicably connected to the first and second master server and operable to:
receive a third message from the first master server, the third message comprising a first plurality of messages and a first priority;  receive a fourth message from the second master server, the fourth message comprising a second plurality of messages
and a second priority;  and process the third and fourth messages to detect a system-wide attack.
<BR><BR> 40.  The system of claim 39 further comprising an archive database, the global server further operable to: receive first archival data from the first master server, the first archival data comprising the full IP data associated with the first
message;  receive second archival data from the second master server, the second archival data comprising substantially all of the IP data associated with the second message;  store the first and second archival data in the archive database;  and
automatically process the archive database to detect a long-term attack.
<BR><BR> 41.  The system of claim 39 further comprising an operator console communicably connected to the global server via secure socket layer technology, the operator console operable to communicate static response messages to the global server.
<BR><BR> 42.  The system of claim 41, the global server further operable to automatically communicate the static response messages to the first and second master server based, at least in part, on a distribution ruleset.
<BR><BR> 43.  The system of claim 33 further comprising a slave server operable to automatically substantially assume the responsibilities of the manager server in the event of a failure of the manager server.
<BR><BR> 44.  The system of claim 33 further comprising: a first slave sensor operable to automatically assume substantially all of the functionality of the first sensor in the event of a failure of the first sensor;  and a second slave sensor operable
to automatically assume substantially all of the functionality of the second sensor in the event of a failure of the second sensor.
<BR><BR> 45.  The system of claim 33, wherein the manager server is operable to process the first and second messages at a speed substantially similar to a maximum processing speed between the first sensor and the second sensor. <HR>
<CENTER><b><i>Description</b></i></CENTER> <HR> <BR><BR>RELATED APPLICATIONS
<BR><BR> This application is related to:
<BR><BR> U.S.  patent application Ser.  No. 10/407,700 for a "DYNAMIC RULE GENERATION FOR AN ENTERPRISE <B><I>INTRUSION DETECTION SYSTEM,</I></B>" filed Apr.  4, 2003 by Jon-Michael C. Brook, Matthew C. Rixon, Randall S. Brooks, and Troy Dean Rockwood; and
<BR><BR> U.S.  patent application Ser.  No. 10/407,030 for a "GRAPHICAL USER INTERFACE FOR AN ENTERPRISE <B><I>INTRUSION DETECTION SYSTEM,</I></B>" filed Apr.  4, 2003 by Jon-Michael C. Brook, Matthew C. Rixon, Randall S. Brooks, and Troy Dean Rockwood.
<BR><BR>TECHNICAL FIELD OF THE INVENTION
<BR><BR> This invention relates to intrusion detection systems and, more specifically, to a vertically extensible <B><I>intrusion detection system</I></B> and method.
<BR><BR>BACKGROUND OF THE INVENTION
<BR><BR> Intrusion detection systems are used by an enterprise to detect and identify unauthorized or unwanted use (commonly called an attack) of the enterprise's computer network, which normally comprises a large number of nodes and network operations
centers (NOCs).  In general, these enterprise intrusion detection systems scan incoming data for specific patterns in network traffic, audit trails, and other data sources to detect malicious activity.  Due to the large quantity of data, conventional
intrusion detection systems often use many analysts to evaluate network data with various tool implementations for identifying the patterns, such as finite state machines, simple pattern matching, or specialized algorithms.
<BR><BR> But conventional intrusion detection systems (IDSs) are not easily scalable across enterprises.  For many of these systems, this lack of scalability is due to the large number of skilled analysts required to detect and monitor intrusions.  For
example, these systems may have a maximum scalability of one analyst/one hundred nodes or sensors.  In short, to further scale the conventional IDS though additional nodes, the enterprise must hire additional expensive analysts.
<BR><BR>SUMMARY OF THE INVENTION
<BR><BR> In accordance with the present invention, the disadvantages and problems associated with traditional enterprise intrusion detection systems have been substantially reduced or eliminated.
<BR><BR> One aspect of the invention is a method for vertically extensible intrusion detection for an enterprise comprising receiving a first packet flow from a first node, the first packet flow comprising at least a portion of packet headers received at
the first node during a first timeframe and receiving a second packet flow, the second packet flow comprising at least a portion of packet headers received at the second node during a second timeframe.  The first and second packet flow are processed to
detect an attack on the enterprise system.  In response to the attack, an alert message is communicated to a master server, a response message is received from the master server, the response message comprising a signature to impede the attack, and the
response message is automatically communicated to the first node and the second node.
<BR><BR> Another aspect of the invention is a vertically extensible <B><I>intrusion detection system</I></B> comprising a first sensor operable to receive data from a first port on a network and a second sensor operable to receive data from a second port on the
network.  The system further comprises a manager server communicably connected to the first and second sensor, the manager server operable to retrieve a first message from the first sensor, the first message comprising binary data for a first timeframe,
retrieve a second message from the second sensor, the second message comprising binary data, for a second timeframe, communicate the first and second messages to a master server, the master server communicably connected to the manager server, and process
the first and second messages to detect an attack on an enterprise system.  In response to the attack, the manager server is further operable to communicate an alert message to the master server, receive a response message from the master server, the
response message comprising a signature to impede the attack, automatically communicate the response message to the first sensor, and automatically communicate the response message to the second sensor.
<BR><BR> The invention has several important technical advantages.  Various embodiments of the invention may have none, some, or all of these advantages.  One advantage of the present invention is that it provides a highly vertically scalable <B><I>intrusion
detection system</I></B> for an enterprise.  This allows fewer analysts to control more nodes, often with less training, thereby, in some cases, reducing costs to the enterprise.  Other technical advantages of the present invention will be readily apparent to
one skilled in the art. <BR><BR>BRIEF DESCRIPTION OF THE DRAWINGS
<BR><BR> For a more complete understanding of the present invention and its advantages, reference is now made to the following descriptions, taken in conjunction with the accompanying drawings, in which:
<BR><BR> FIG. 1 illustrates a portion of a vertically extensible <B><I>intrusion detection system</I></B> according to various embodiments of the present invention;
<BR><BR> FIG. 2 illustrates an embodiment of a sensor in accordance with the system of FIG. 1;
<BR><BR> FIGS. 3A-C illustrate various embodiments of a correlation engine of the system of FIG. 1;
<BR><BR> FIG. 4 illustrates an embodiment of a graphical user interface in accordance with the system of FIG. 1;
<BR><BR> FIG. 5 illustrates an embodiment of a hash table used by the graphical user interface of FIG. 4;
<BR><BR> FIG. 6 is a flowchart illustrating a method for aggregating a plurality of flows in accordance with the vertically extensible <B><I>intrusion detection system</I></B> of FIG. 1;
<BR><BR> FIG. 7 is a flowchart illustrating a method for dynamic rule generation in accordance with the vertically extensible <B><I>intrusion detection system</I></B> of FIG. 1; and
<BR><BR> FIG. 8 is a flow chart illustrating a method for generating a user interface using sorted packet flows for use by graphical user interface of FIG. 4.
<BR><BR>DETAILED DESCRIPTION OF EXAMPLE EMBODIMENTS OF THE INVENTION
<BR><BR> FIG. 1 illustrates a portion of a vertically extensible <B><I>intrusion detection system</I></B> 10 distributed across an enterprise system according to various embodiments of the present invention.  The "enterprise" may comprise any business, government,
organization, or other large entity that has multiple network channels or ports to an external network 100.  For example, a business enterprise may include four ports for external network communications including email, internet, and dialup.  In this
example, <B><I>intrusion detection system</I></B> 10 monitors network communications on the three external ports and attempts to detect, locate, or block an attack on the business.  An "attack" may be any malicious, destructive, or suspicious activity communicated
from a source external to the portion of the enterprise protected by system 10.  Attacks may include viruses, Trojan horses, worms, or any other piece of code or data that represents at least a portion of an unwanted attempt to access the protected
portion of the enterprise.  Returning to the example, one attack on the business may comprise two different packets, each communicated from the same source but through a different network port.  Another attack may comprise two different packets
communicated separately over a substantial length of time.  These attacks and those of similar nature may not be detected by firewalls, sensors, or other traditional intrusion detection systems.
<BR><BR> According to certain embodiments, <B><I>intrusion detection system</I></B> 10 comprises multiple logical levels, each level operable to control, monitor, or update lower logical levels.  Each level further provides combinatorial detection across a plurality
of logically-lower nodes.  In short, system 10 provides the enterprise with, at a minimum, vertically and horizontally extensible intrusion detection.  Vertically extensible generally means that system 10 may easily add an additional logical level
(comprising one or more servers) providing further combinatorial detection across the plurality of logically lower nodes and/or reduced information to levels located logically higher than the added level.
<BR><BR> <B><I>Intrusion detection system</I></B> 10 comprises a plurality of sensors 20, one or more manager servers 30, global server 40, and console 50.  Generally, <B><I>intrusion detection system</I></B> 10 may hierarchically couple manager servers 30 such that multiple levels
exist.  For example, system 10 may include four levels: sensor level 120, manager server lower-level 130b, manager server (or master server) upper-level 130a, and global server 40.  Accordingly, <B><I>intrusion detection system</I></B> 10 is vertically extensible and
dynamically responds to attacks on the enterprise.  It will be understood that system 10 comprises any number of levels and, thus, is significantly scaleable across the enterprise.  Each level detects an attack on the enterprise system based on
communications from lower levels, dynamically responds to the attack, and, when appropriate, automatically communicates response messages to lower levels.  It should be understood that the levels represent logical levels as opposed to physical systems
and that one or more modules or levels of system 10 may be included in the same computing device.  Further, the term "automatically," as used herein, generally means that the appropriate processing is substantially performed by system 10.  It should be
understood that automatically further contemplates any suitable user interaction with system 10.
<BR><BR> The various levels in the hierarchy are located in a portion of internal network 80.  Internal network 80 may include one or more intranets, local area networks (LANs), metropolitan area networks (MANs), wide area networks (WANs), or any other
suitable enterprise network.  Network 80 may, for example, communicate Internet Protocol (IP) packets, frame <B><I>relay</I></B> frames, Asynchronous Transfer Mode (ATM) cells, and/or other suitable messages between network addresses.  According to particular
embodiments, messages between the levels may be in one or more formats including Intrusion Detection Message Exchange Format (IDMEF), binary format, and/or any other appropriate format.  Generally, the messages include at least packet flows 70, alert
messages 71, response messages 72, processing messages 73, and archival data 74.  Each packet flow 70 is a plurality of network packet headers passed up through the levels.  According to certain embodiments, packet flow 70 represents a compression of all
or a portion of packet information sent from an external source IP address to an internal destination IIP address within a set timeframe, normally from the TCP handshake to the TCP reset/timeout.  In another embodiment, packet flow 70 may include a
compression of subnet communications to other IP addresses or subnets, UDP communications, or ARP communications.  Alert messages 71 may be any communication that alerts a higher level of a possible attack such as, for example, IDMEF IDS alerts.  Each
response message 72 comprises an intrusion signature, rule, or instruction that is used by at least one node to detect, identify, or impede an attack on the enterprise system.  As used herein, response messages 72 include static and dynamic response
messages.  Processing messages 73 comprise commands sent from one node in system 10 to another node such as, for example, from manager server 30 to sensor 20.  Archival data 74 generally comprises the full set of information and data associated with an
attempt to access internal network 80 and may be created using any appropriate technique.  For example, archival data 74 may be created by a "TCPDump" command to include all data communicated between the source IP address to the destination address in
binary format.  Messages may include any other suitable communication operable to communicated from a node and processed by other nodes or levels.  Any or all of the communications may be secured through associating the respective message with a first
verification value or digital signature that may be decoded by the receiving node without departing from the scope of this disclosure.  Accordingly, each node may be operable to compute a second verification value based on the communication and, in
response to the first and second verification values not being equal, refuse the communication.
<BR><BR> External network 100 represents any network not protected by <B><I>intrusion detection system</I></B> 10.  Accordingly, external network communicably couples system 10 and external computer systems.  Network 100 may, for example, communicate Internet Protocol
(IP) packets, frame <B><I>relay</I></B> frames, Asynchronous Transfer Mode (ATM) cells, and/or other suitable information between network addresses.  Network 100 may include one or more intranets, local area networks (LANs), metropolitan area networks (MANs), wide
area networks (WANs), all or a portion of the Internet, and/or any other communication system or systems at one or more locations.  The external client system (not shown) may be any computer, enterprise or non-enterprise, which is trying to access the
portion of internal network 80 protected by <B><I>intrusion detection system</I></B> 10.  As used in this document, the term "computer" is intended to encompass a personal computer, terminal, workstation, network computer, kiosk, wireless data port, wireless
telephone, personal digital assistant (PDA), one or more processors within these or other devices, or any other suitable processing device.
<BR><BR> As described earlier, <B><I>intrusion detection system</I></B> 10 comprises a plurality of levels with each level comprising nodes such as sensors 20, one or more manager servers 30, global server 40, and console 50.  In the illustrated example, system 10
comprises server level 120 comprising a plurality of sensors 20, manager server level 130b comprising a plurality of manager servers 30b, and master server level 130a comprising one or more master servers 30a.  Each sensor 20 is located at a network port
that receives TCP/IP packets or other similar network communications from external network 100.  Generally, sensor 20 processes the raw data to detect the presence of an attack and outputs at least the raw data and, when appropriate, a corresponding
alert message 71.  In certain embodiments, sensor 20 may also generate messages, such as a packet flow 70, based on the raw data received from external network 100.
<BR><BR> Sensor 20 may use any suitable detection technique to process incoming data and output the appropriate messages.  For example, sensor 20 may use algorithms, signatures, scripts, or any suitable detection or comparison technique to process packet
headers, packet payloads, and/or any other incoming data.  Sensor 20 could include any hardware, software, firmware, or combination thereof operable to receive data from external sources via network 100, process the raw network data, and communicate
results to higher levels.  For example, sensor 20 may comprise a computer, server, lower-level <B><I>intrusion detection system,</I></B> firewall, or any module written in any appropriate computer language such as, for example, C, C++, Java, Perl, and others.  It will
be understood that while sensor 20 is illustrated as a single multi-tasked module, the features and functionality performed by this engine may be performed by multiple modules such as for example, a sensor module and a packet flow generation module. 
Additionally, to help ensure that each port is properly monitored, each sensor 20 may be associated with a redundant slave sensor, illustrated as slave sensor 20b, which is operable to assume substantially all of the functionality of the sensor 20 in the
event of any failure of sensor 20.
<BR><BR> In one embodiment, sensor 20 processes each incoming packet according to a response message file 25.  Response message file 25 may include XML tables, flat files, CSV files, SQL statements, relational database tables, HTML pages, or any other
appropriate data structure to store at least one response message 72.  System 10 may include one response message file 25 for use by a plurality of sensors 20 or one response message file 25 per sensor 20, as appropriate.  In other words, response
message file 25 may be separated into multiple tables, consolidated into one table, or stored inside sensor 20, without departing from the scope of the disclosure.  As described in more detail in FIG. 3C, upper levels of system 10 dynamically generate
response messages 72 based on a detected attack and communicate these response messages 72 to the appropriate response message files 25 through manager servers 30.  Each response message file 25 may further include static response messages 72.  Static
response messages 72 may be stored in a database, encrypted with a hash value, and communicated to identifiable portions of entire system 10 such as, for example, all sensors 20 behind enterprise firewalls.
<BR><BR> Manager server 30 represents any hardware or software module that controls or monitors one or more servant nodes.  In one example, each manager server 30 includes a correlation engine 31 and a correlation ruleset 33, described in more detail in
FIGS. 3A through 3C, for receiving and correlating data from lower-level nodes.  Generally, through correlating and aggregating lower-level communications, manager server 30 is capable of detecting an attack occurring across multiple servant nodes and
dynamically responding to such a threat.  The servant nodes may include sensors 20 or lower-level manager servers 30.  For readability purposes, the term master server may be used to describe an upper-level manager server 30 which has other manager
servers 30 as servant nodes.  Normally, one or more lowest-level manager servers 30 control and monitor a plurality of sensors 20.  In certain embodiments, each low-level manager server 30 may receive raw data from sensors 20, such as in binary format,
and generate packet flow 70 for use by upper-level manager servers 30.
<BR><BR> According to certain embodiments, manager server 30 comprises a general-purpose personal computer (PC), a Macintosh, a workstation, a Unix-based computer, a server computer, or any other suitable processing device.  Additionally, to make system
10 more robust, each manager server 30 may be associated with a redundant manager server, illustrated as manager server 30b, which is operable to assume substantially all of the functionality of manager server 30 in the event of a failure of the
associated manager server 30.  Although FIG. 1 provides one example of a server 30 that may be used with the invention, system 10 can be implemented using computers other than servers, as well as a server pool.  Manager server 30 may include any
hardware, software, firmware, or combination thereof operable to receive communications from lower levels, appropriately process the communications, and dynamically respond.  According to one embodiment, manager server 30 may comprise a web server.  One
function of manager server 30 might be to allow an external client to send or receive content over or from the Internet using a standard user interface language such as, for example, the Extensible Markup Language (XML) or Hypertext Markup Language
(HTML).  Manager server 30 would then include sensors 20 that can accept data from the external client via a web browser (e.g., Microsoft Internet Explorer or Netscape Navigator) and return the appropriate HTML responses.
<BR><BR> At the highest logical level, system 10 comprises global server 40.  Generally, global server 40 is operable to receive alert messages 71, response messages 72, and archival data 74 from each node in system 10 and ensure that response messages
72 are distributed to the appropriate lower nodes.  It should be understood that global server 40 may further include functionality similar to that described in regard to manager server 30.  For example, global server 40 may communicate a first response
message 72 to every sensor 20 via the manager server 30 levels.  In another example, global server 40 may determine that only a portion of sensors 20 would benefit from a second response message 72 and, thus, communicates second response message 72 to
only the appropriate manager servers 30 in the hierarchy.  Global server 40 may comprise a general-purpose personal computer (PC), a workstation, a Unix-based computer, a server computer, or any other suitable device.  Although FIG. 1 provides one
example of global server 40 that may be used with the invention, system 10 can be implemented using computers other than servers, as well as a server pool.  Global server 40 may include any hardware, software, firmware, or combination thereof operable to
process control and monitor system 10 at the highest logical level.
<BR><BR> Global server 40 may include an archive database 45 to store the raw archival data 74 for later processing, retrieval, or searches.  Archive database 45 may include any memory or database module and may take the form of volatile or non-volatile
memory comprising, without limitation, magnetic media, optical media, random access memory (RAM), read-only memory (ROM), removable media, or any other suitable local or remote memory component.  In one embodiment, archive database 45 comprises stored IP
information such as, for example, TCPDump data corresponding to each packet flow 70.  Archive database 45 may include any other data such as, for example, historical operator commands or response messages 72 previously communicated to lower nodes without
departing from the scope of this disclosure.
<BR><BR> Global server 40 may include a global correlation engine 31 that is further operable to process archive database 45 to detect the presence of a substantially long-term or multi-staged attack that had previously gone undetected by sensors 20 and
manager servers 30 using packet flows 70.  Although FIG. 1 illustrates archive database 45 as residing internally to global server 40, archive database 45 may reside externally or at any other location or locations accessible by global server 40.
<BR><BR> Global server 40 further may comprise a filtering ruleset 47.  Filtering ruleset 47 allows system 10 to reduce the analyst's workload through filtering the information communicated to console 50.  Ruleset 47 comprises instructions, algorithms,
or any other directive which largely controls the information communicated to console 50.  Although FIG. 1 illustrates filtering ruleset 47 as residing internally to global server 40, filtering ruleset 47 may reside externally at one or more manager
servers 30 or at console 50 without departing from the scope of this disclosure.
<BR><BR> <B><I>Intrusion detection system</I></B> 10 may communicate the resulting, information to console 50 so that a user, such as a supervisor or administrator, may view the desired packet flows 70 and alert messages 71.  System 10 may filter the communications to
console 50 based on the filtering ruleset 47.  Console 50 also allows the communication of static response messages 72 to global server 40 for distribution to the appropriate lower nodes.  Console 50 may represent any computer that may comprise input
devices, output devices, mass storage media, processors, memory, or other components for receiving, processing, storing, and/or communicating information.  It will be understood that there may be any number of consoles 50 coupled to network 100 such as,
for example, one or more operator or analyst consoles 50 and a supervisor console 50.
<BR><BR> Console 50 is communicably connected to global server 40 via communications channel 55, which may be direct-line, encrypted, or any other type of substantially secure communication channel.  The security of communications channel 55 helps ensure
that any static response messages 72 that global server 40 receives via channel 55 is from the appropriate console 50--not from an external or unauthorized source.  According to certain embodiments, communications channel 55 may utilize Secure Sockets
Layer (SSL) technology.  SSL is a transport level technology for authentication and data encryption between two nodes on a network.  SSL negotiates point-to-point security between console 50 and global server 40.  It sends data over a "socket", a secure
channel at the connection layer existing in most TCP/IP applications.  Information being transmitted via communications channel 55 is encrypted and only the respective console 50 and global server 40 have the key and, therefore, the ability to understand
and decipher transferred information.  Console 50 may be, alternatively or additionally, linked to one or more master servers 30 without departing from the scope of this disclosure.
<BR><BR> Console 50 may include a graphical user interface (GUI) 52 that tailors and filters the data presented to the user, illustrated in more detail in FIG. 4.  Generally, GUI 52 provides the user of console 50 with an efficient and user-friendly
presentation of data and events occurring in system 10.  GUI 52 may open a secure shell (SSH) tunnel to provide additional secure communications between console 50 and the other portions of system 10.  GUI 52 may comprise a plurality of displays having
interactive fields, pull-down lists, and buttons operated by the user.  In one example, GUI 52 presents the descriptive information of each packet flow 70 to the user and conceals the remaining information in order to reduce visual clutter.  Then, upon
receiving a request from the user, GUI 52 expands the visual representation of packet flow 70 to further display the packet headers and payloads to the user.  GUI 52 may include multiple levels of abstraction including groupings and boundaries.  It
should be understood that the term graphical user interface may be used in the singular or in the plural to describe one or more graphical user interfaces and each of the displays of a particular graphical user interface.  Further, GUI 52 contemplates
any graphical user interface that processes information from vertically extensible <B><I>intrusion detection system</I></B> 10, or other appropriate system, and efficiently presents the information to a user.
<BR><BR> In one aspect of operation, manager server 30 communicates processing message 73 to sensor 20 to ensure that sensor 20 operates according to a particular set of criteria such as, for example, periodically polling response message file 25 for
current and expired response messages 72.  Accordingly, sensor 20 monitors the respective port in network 80 when the port receives a request to initiate communications from an external computer via external network 100.  Once the communication session
is initiated, sensor 20 begins processing substantially all of the data communicated from the external system based on response message file 25.  After processing the packets, sensor 20 communicates the raw IP archival data 74, in binary format, to
low-level manager server 30.  If sensor 20 determines that one or more packets represents a portion of an attack on the enterprise, then sensor 20 generates an alert message 71.  In certain embodiments, sensor 20 may combine a plurality of packets into
packet flow 70 based on any appropriate criteria such as, for example, source address, destination address, or packet payload and assign a priority to the generated packet flow 70.  For example, to reduce the data processed by upper levels, sensor 20 may
only compress a plurality of packets to packet flow 70 if one of the packets represents at least a portion of an attack.  In another example, sensor 20 may combine all plurality of packets into packet flows 70.  One example packet flow 70 comprises
descriptive information, packet headers, and the assigned priority and is in IDMEF format.  The descriptive information may include the count of packets in the packet flow, a timestamp, a class, or any other suitable data.  Sensor 20 then associates the
alert message 71 with packet flow 70 and communicates packet flow 70 and the associated alert message 71 to the supervising low-level manager server 30.  The term "associated," as used herein, may mean incorporated into, linked with, or any other logical
or physical relation.
<BR><BR> Manager server 30 receives the data, either binary or packet flow 70, from sensors 20.  If the data is received in binary format, then low-level manager server 30 reduces the data to packet flows 70 based on any appropriate criteria such as, for
example, source address, destination address, or packet payload.  Once packet flows 70 are received or generated, manager server 30 correlates packet flows 70 with any associated alert messages 71.  Based on this correlation, manager server 30 assigns a
priority to packet flow 70.  Manager server 30 may also assign a priority to packet flow 70 if it determines that packet flow 70 represents a relatively uncommon communication.  Further, manager server 30 may associate two or more flows 70 into a
combined (aggregated) flow 70 based on any suitable criteria such as, for example, a correlation ruleset 33, source address, alert message 71, or flow priority.  Aggregation allows system 10 to detect and respond to substantially long-term or multi-port
attacks.  Manager server 30 may then communicate combined flow 70 to higher levels, comprising master servers and global server 40, based on the flow priority.  Once received, the appropriate upper level server 30 or 40 generates one or more HTML pages,
based on filtering ruleset 47, for communication to console 50.
<BR><BR> If any manager server 30 (or global server 40) detects that one or more packet flows 70 represent an attack on the enterprise, the respective server 30 or 40 automatically generates a new response message 72 for impeding the attack and assigns a
higher priority to the combined flow 70.  Manager server 30 dynamically distributes the generated response message 72, comprising a new signature or rule, to the lower and higher nodes.  To reduce system overhead, this distribution may not be to every
node in system 10.  Instead, manager server 30 may communicate response message 25 to certain nodes based on the respective port's communication type or any other suitable criteria.  As described above, manager server 30 may also attach a digital
signature or other verification value to response message 72 to help ensure the security of the message.  Once the lowest manager server 30 receives response message 72, it communicates the dynamic response message 72 to appropriate response message file
25 for one or more sensors 20.  Manager server 30 may also communicate a new processing message 73 to each sensor 20.  Again, processing message 73 represents processing instructions for sensor 20 such as, for example, to poll response message file 25 at
certain time increments.  Based on processing message 73, sensor 20 retrieves the dynamically generated response message 72 from response message file 25 and impedes or detects similar future attacks.
<BR><BR> The preceding description details various techniques for detecting attacks on an enterprise system using vertically extensible <B><I>intrusion detection system</I></B> 10.  While these techniques have been described in particular arrangements and
combinations, system 10 contemplates using any appropriate combination and ordering of these operations to provide for vertical scalability using manager servers 30.
<BR><BR> FIG. 2 illustrates an embodiment of a sensor 20 in accordance with system 10.  As described above, while sensor 20 is illustrated as a single module, the features and functionalities performed by these modules may be performed by multiple
modules.  Sensor 20 may be any hardware, software, firmware, logic, or combination thereof operable to process communications from network 100 based on response message file 25.  Sensor 20 may be written in any appropriate computer language such as, for
example, C, C++, Java, Assembler, and others.  Indeed, system 10 contemplates that the processes and functionality of manager servers 30 are substantially independent of the architecture of sensors 20.
<BR><BR> Generally, sensor 20 processes input from network 100 and outputs packet flow 70, TCPDump archival data 74, and, when appropriate, IDMEF alert messages 71.  As described above, sensor 20 may also assign a priority to packet flow 70.  According
to certain embodiments, system 10 comprises response message file 25, processing ruleset 26, and IDMEF plug-in 27 for each sensor.  Ruleset 26 comprises instructions, algorithms, processing messages 73, or any other directive which largely controls the
processes of sensor 20.  Ruleset 26 allows system 10 to incorporate and control a wide array of sensors 20 without substantial redesign or modification.  It should be understood that while processing ruleset 26 is illustrated as external to sensor 20,
ruleset 26 may be internal without departing from the scope of the disclosure.  IDMEF plug-in 27 is an example plug-in that comprises instructions, algorithms, or any other directive that directs sensor 20 to output the proper format of certain data such
as, for example, IDMEF.  Any formatting plug-in may be used in place of or in combination with IDMEF plug-in 27 without departing from the scope of this disclosure.
<BR><BR> In one aspect of operation, manager server 30 communicates processing message 73 to processing ruleset 26.  One example of processing message 73 stored in processing ruleset 26 comprises a command instructing sensor 20 to poll response message
file 25 at regular intervals for updates and expirations of response messages 72.  Another example of processing message 73 comprises a directive to sensor 20 to reset or initialize itself to clear out old data or processes.  Yet another example of
processing message 73 comprises an instruction to first sensor 20 to shutdown and allow slave sensor 20 to assume the processes of first sensor 20.  This example may allow system 10 to dynamically upgrade or replace first sensor 20 without a loss of
protection at the respective port.  Further examples include the processing message comprising an instruction to the sensor to poll the response message file to intercept one or more of the plurality of packets or to close an associated port.
<BR><BR> Sensor 20 monitors incoming data from external network 100 based on processing ruleset 26.  Sensor 20 processes the data using response messages 72 (or rules) stored in response message file 25.  In response to detecting an attack, identified by
one or more response messages 72, sensor 20 generates an alert message 71 and communicates the generated alert message 71 to its respective manager server 30.  Sensor 20 may also generate a packet flow 70, using the various communications from external
network 100, and assign a priority to packet flow 70.  Whether an attack is detected or not, sensor 20 communicates the received data up the hierarchy, via manager server 30, in either binary format or as packet flow 70 for subsequent analysis.
<BR><BR> FIGS. 3A through 3C illustrate various embodiments of correlation engine 31 in accordance with system 10.  It will be understood by those skilled in the art that correlation engine 31 may reside locally in manager server 30, remotely on another
computer server, or distributed across servers.  It will be further understood that while correlation engine 31 is illustrated as a single module, the features and functionalities performed by these modules may be performed by multiple modules. 
Correlation engine 31 may be any software or logic operable to process multiple communications from servant nodes.  Correlation engine 31 may be written in any appropriate computer language such as, for example, C, C++, Java, Assembler, and others.
<BR><BR> FIGS. 3A-B illustrate various embodiments of correlation engine 31 operable to dynamically generate rules or signatures (for incorporation in response messages 72) and distribute the new rules in accordance with system 10.  Generally,
correlation engine 31 receives data from servant nodes, processes the data, and dynamically generates response messages 72.  Correlation engine 31 then communicates at least a portion of the data up the system 10 hierarchy to upper-level manager servers
30 or global server 40 and distributes the response messages 72 to the appropriate servant nodes.
<BR><BR> Correlation engine 31 is communicably linked with a correlation ruleset 33 and a security table 34.  Correlation ruleset 33 comprises instructions, algorithms, or any other directive that is used by correlation engine 31 to properly process
packet flows 70 and alert messages 71.  Ruleset 33 allows manager server 30 to quickly change processing rules without extensive redesign or modification.  This adaptability allows easier scalability of system 10.  Security table 34 may be of any
suitable format comprising XML tables, flat files, comma-separated-value (CSV) files, SQL tables, relational database tables, and others.  In one embodiment, security table 34 is a multidimensional data structure that comprises at least one signature or
response message 72.
<BR><BR> In one aspect of operation, illustrated in FIG. 3A, correlation engine 31 detects an attack through a number of ways such as, for example, receiving alert messages 71 from servant nodes or aggregating packet flows 70 from multiple servant nodes
to determine a multi-port or multi-staged attack.  In the first example, correlation engine 31 receives a plurality of packet flows 70 and alert messages 71 from servant nodes.  Based on correlation ruleset 33, correlation engine 31 associates a first
alert message 71 with a first received packet flow 70.  In certain embodiments, correlation engine 31 associates alert message 71 with packet flow 70 using any suitable criteria such as, for example, source address or destination address.  Based on this
association, correlation engine 31 may dynamically generate a new response message 72 and distribute response message 72 to the appropriate servant nodes.  In a second example, correlation engine 31 efficiently and reliably analyzes data from multiple
servant nodes through aggregation.  Correlation engine 31 receives at least two packet flows 70 from servant nodes and then combines the first and second flows 70 into third packet flow 70.  Based on this aggregation, correlation engine 31 processes the
combined data to detect an attack that is spread among the servant nodes.  In this way, system 10 is can easily protect numerous ports.  Further, this technique of aggregation provides system 10 with horizontally extensibility through easily adding
sensors to new ports without significant redesign or modification.
<BR><BR> In another aspect of operation, illustrated in FIG. 3B, after correlation engine 31 aggregates first and second packet flows 70 into third packet flow 70, correlation engine 31 assigns a priority to third packet flow 70 and passes third packet
flow 70 up the hierarchy based on the priority.  For example, correlation engine 31 compares the first and second priority from the first and second flows 70.  Then, in response to the first priority not being less than the second priority, correlation
engine 31 assigns the first priority to the third packet flow 70.  Or, in response to the second priority being greater than the first priority, correlation engine 31 assigns the second priority to the third packet flow 70.  In a second example,
correlation engine 31 computes a priority of the third packet flow 70 based, at least in part, on alert message 71 or a detected uncommon event and assigns the computed priority to the third packet flow 70.  It should be understood that correlation
engine 31 may not communicate packet flow 70 to an upper-level manager server 30 if the priority of packet flow 70 is not high enough.
<BR><BR> FIG. 3C illustrates two correlation engines 31a and 31b, each residing on manager server 30a or 30b, respectively.  The use of multiple manager servers 30, or correlation engines 31, allows system 10 to create a hierarchy spanning internal
network 80.  As desired, system 10 may easily add additional manager servers 30 to handle additional workloads or network ports.  In this embodiment, manager server 30a is logically higher in the system 10 hierarchy than manager server 30b.  Accordingly,
manager server 30a may be described as master server 30a to aid readability.
<BR><BR> Master server 30a is communicably linked to manager server 30b.  Manager server 30b is communicably linked to two servant nodes, first and second sensors 20.  It will be understood that this is for illustrative purposes only and that master
server 30a may include any number of servant nodes, comprising other manager servers 30 or sensors 20 (not shown).  As well, manager server 30b may include any number of additional servant nodes, comprising manager servers 30 or sensors 20, without
departing from the scope of this disclosure.
<BR><BR> Each illustrated server 30 comprises database 32a and 32b, respectively.  Database 32 may include any memory or database module and may take the form of volatile or non-volatile memory comprising, without limitation, magnetic media, optical
media, random access memory (RAM), read-only memory (ROM), removable media, or any other suitable local or remote memory component.  In this embodiment, database 32 comprises a correlation ruleset 33 and a security table 34, described in more detail in
FIG. 3A.  Database 32 may include any other data such as, for example, an archival database table or other suitable data.
<BR><BR> In one aspect of operation, each sensor 20 processes data from external network 100 as described in FIG. 2.  Each sensor 20 processes the data and outputs the data in binary format.  Each sensor 20 may also reduce its respective packets to
packet flow 70 and communicates it to manager server 30b.  If sensor 20 detected an abnormal or problematic packet, then sensor 20 may, alternatively or in combination, create an alert message 71, which is also communicated to manager server 30b, or
assign a priority to packet flow 70.
<BR><BR> Once manager server 30b retrieves the data from first and second sensor 20, manager server 30b processes the information for possible distribution to upper levels.  In one embodiment, manager server 30b retrieves binary data output from each
sensor 20 and reduces portions of the data into packet flows 70.  In another embodiment, manager server 30b receives first and second packet flow 70 from the first and second sensor 20, respectively.  Correlation engine 31b processes the packet flows 70
based on correlation ruleset 33 to determine if any of the data represents at least a portion of an attack on the enterprise.  This processing may include correlating one alert message 71 with one packet flow 70, aggregating two or more packet flows 70
into a third packet flow 70, or analyzing the priority of one or more of the packet flows 70.  Correlation engine 31b may communicate the packet flow 70 to master server 30a if an attack is detected, the priority of packet flow 70 is high enough, or
based on any other suitable criteria.  If correlation engine 31b detects a portion of an attack, then manager server 30b may dynamically generate a response message 72 based on the alert message 71 or the packet flow 70.  In this case, manager server 30b
would store the new response message 72 in security table 34 and communicate new response message 72 to the appropriate sensor or sensors 20.  Manager server 30b also may communicate response message 72 to master server 30a in order that the response
message 72 may be distributed as appropriate.  According to certain embodiments, manager server 30b may also generate an HTML page based on the processing of packet flows 70.  Each HTML page may be associated with one or more packet flows 70 and
communicated to console 50 via master server 30a.
<BR><BR> Master server 30a receives the plurality of communications from its servant nodes, comprising manager server 30b.  Correlation engine 31a processes the packet flows 70 based on correlation ruleset 33 to determine if any of the data represents at
least a portion of an attack on the enterprise that was not detected by manager server 30b.  This processing may include correlating one alert message 71 with one packet flow 70, aggregating two or more packet flows 70 into a third packet flow 70, or
analyzing the priority of one or more of the packet flows 70.  Correlating engine 31a may include additional functionality to ensure proper control and monitoring of servant nodes, comprising manager server 30b.
<BR><BR> FIG. 4 illustrates an example embodiment of a graphical user interface (GUI) 52 in accordance with system 10.  As described above, GUI 52 provides an efficient and user-friendly presentation of data and events occurring in system 10 to a user of
console 50.  GUI 52 may comprise a plurality of displays having interactive fields, pull-down lists, and buttons operated by the user.  GUI 52 may comprise a web browser (e.g., Microsoft Internet Explorer or Netscape Navigator) that receives input from
system 10 and presents the appropriate HTML pages to console 50.  While GUI 52 is described in terms of Hypertext Markup Language (HTML), GUI 52 may be developed using any user interface language such as, for example, Extensible Markup Language (XML) or
JavaScripts.  It will be understood by those skilled in the art that GUI 52 may reside locally in console 50, remotely on another computer server, or distributed across computers.  It will be further understood that while GUI 52 is illustrated as a
single module, the features and functionalities performed by these modules may be performed by multiple modules such as, for example, a web browser and a filtering module.
<BR><BR> GUI 52 displays visual representations of one or more packet flows 70 based, in part, on filtering ruleset 47.  GUI 52 further allows a user to interactively customize the view based on multiple groupings 56 or boundaries such as, for example,
VPN groupings, firewall groupings, sites or other geographic locations, communication types, trust levels of ports, or any other appropriate level of abstraction.  For example, VPN groupings may allow the user to select only those packet flows 70
received from a VPN (Virtual Private Network) or non-VPN connection and firewall groupings may allow the user to select only those packet flows 70 received from behind or beyond a selected firewall.  These levels of abstraction reduce the visual clutter
and allow for more efficient viewing and detecting of possible attacks on system 10.  The user may select one or more of groupings 56 to organize (sort, filter, or any other appropriate processing) information as desired.
<BR><BR> Accordingly, in certain embodiments, GUI 52 comprises a browser window that displays a parent HTML page comprising descriptive information 53 and link 54 to a child HTML page for each packet flow 70.  These HTML pages are generated by system 10
on any computer or server in system 10 comprising console 50, global server 40, or manager server 30.  Descriptive information 53 presents relevant identifying data for each packet flow 70.  For example, descriptive information 53 may include source
address, destination address, grouping information, the number of packets included in the respective packet flow 70, or any other information suitable for identifying a particular packet flow 70.  Link 54 allows GUI 52 to conceal the packet headers and
packet payloads of each packet flow 70 from the user of console 50.  This provides a much cleaner interface to the user, thereby resulting in an improved and/or quicker analysis.  Each link 54 may be colored, such as red or green, to represent the
priority of packet flow 70.  Further the data displayed in GUI 52 may be sorted by priority or any other criteria using a hash table 75, illustrated in FIG. 5.
<BR><BR> FIG. 5 illustrates an embodiment of hash table 75 used by graphical user interface 52 in accordance with system 10.  While described in terms of global server 40, hash table 75 may reside on one or more computers or servers in system 10
comprising console 50 or manager server 30.  Generally, hash table 75 allows system 10 to efficiently sort packet flows 70 without the many resources that would be needed to sort the vast amount of data included in each packet flow 70.  For example, GUI
52 may use hash table 75 to sort packet flows 70, for display to the user of console 50, using any criteria.  Hash table 75 comprises hash values 76 and arrays 77.  Hash value 76 is any value that uniquely identifies packet flow 70 and may be computed
using any hashing algorithm such as, for example, MD-5.  Each hash value 76 is associated with one array 77.  Each array 77 comprises substantially all of packet flow 70 information comprising descriptive information, packet headers, packet payloads, and
others.
<BR><BR> In one aspect of operation, global server 40 creates one unique hash value 76 for each packet flow 70 received from lower nodes.  Each packet flow 70 may be stored in array 77 for easier processing by global server 40.  Global server 40 then
sorts hash table 75 using any suitable criteria and generates the HTML pages based on the sorted hash table 75.  In another embodiment, global server 40 communicates the sorted hash table 75 to GUI 52 to allow for a more dynamic generation of sorted HTML
pages.
<BR><BR> FIG. 6 is a flowchart illustrating a method 600 for aggregating a plurality of flows in accordance with vertically extensible <B><I>intrusion detection system</I></B> 10.  In certain embodiments, method 600 enables system 10 to easily scale manager servers
30, while detecting attacks in internal network 80.  Method 600 may be described with respect to modules in system 10 of FIG. 1, but any other suitable system may use method 600 without departing from the scope of this disclosure.
<BR><BR> Data is received from external network 100 at a first sensor 20 in step 602.  At step 604 data is received from external network 100 at a second sensor 20.  As described above, the data is generally received from computers residing outside of
internal network 80, which is the network protected by system 10.  Each sensor 20 processes the received raw data according to any suitable intrusion detection technique at step 606.  At decisional step 608, if an attack is detected, execution proceeds
to step 610.  At step 610, each sensor 20 that detected an attack communicates one or more alert messages 71 to low-level manager server 30.  Next, or if an attack was not detected at decisional step 608, sensor 20 communicates the raw data to low-level
manager server 30 using any appropriate format.  For example, system 10 contemplates sensor 20 communicating a plurality of packets in binary format (such as TCPDump) or reduced to packet flow 70.  Based on the type of sensor 20, sensor 20 either outputs
the data in binary format at step 612 or outputs the data as packet flow 70 at step 616.  In certain embodiments, in step 612 sensor 20 may output the data in binary format to a binary file, the binary file operable to be accessed by low-level manager
server 30.  At step 614, low-level manager server 30 either receives the binary output from sensor 20 or retrieves the binary output from a binary file (not shown).  Once low-level manager server 30 receives the binary output, manager server 30 combines
the binary data into packet flow 70 based, at least in part, on source IP address, destination IP address, priority, packet payload, or any other suitable criteria.  Returning to step 616, sensor 20 outputs the data as packet flow 70 by communicating it
to low-level manager server 30.  At step 618 manager server 30 receives packet flows 70 for use by correlation engine 31.  For archival purposes, sensor 20 communicates binary archival data 74 to global server 40 via the manager server 30 hierarchy for
storage in archive database 45 at step 622.
<BR><BR> Once sensors 20 have finished processing the data and the data is received at low-level manager server 30, manager server 30 correlates alert messages 71 with packet flows 70 based on source IP address, destination IP address, or any other
suitable criteria.  At step 626, correlation engine 31 aggregates two or more plurality of packets (or packet flows 70) into third packet flow 70.  Once third packet flow 70 is generated, manager server 30 processes the third packet flow 70 to detect an
attack that is occurring across at least first and second sensor 20.  If an attack is detected at decisional step 629, then low-level manager server 30 communicates an alert message 71 to the next level in the hierarchy of system 10.  For example, the
next level may be an upper-level manager server 30 or global server 40.  Method 600 then proceeds to steps 631 to 634 where a priority is assigned to packet flows 70 being processed by manager server 30.
<BR><BR> At decisional step 631, manager server 30 determines if any of the former packet flows 70, which were aggregated into third packet flow 70, were assigned a priority by a servant node.  At step 632, if one of the former packet flow 70 were
assigned a priority, manager server 30 may then assign the highest priority from the former packet flows 39 to third packet flow 70.  Alternatively or in combination, manager server 30 may assign a new priority to third packet flow 70 at step 634 based
on a newly detected attack using a security table or correlation ruleset.  At step 636, manager server 30 determines a verification value, such as a hash value, for third packet flow 70 and any associated communications such as alert message 71.  The now
secure third packet flow 70 is communicated to an upper level in the hierarchy such as master server 30, based on the priority assigned third packet flow 70.  For example, low-level manager server 30 may not communicate third packet flow 70 to master
server 30 if the priority is not high enough.
<BR><BR> FIG. 7 is a flow chart illustrating a method 700 for dynamic rule generation in accordance with vertically extensible <B><I>intrusion detection system</I></B> 10.  Generally, method 700 provides system 10 with the ability to be vertically extensible or
scalable through dynamically responding to attacks or threats across multiple ports.
<BR><BR> Data is received from external network 100 at a first servant node in step 702.  At step 704, data is received from external network 100 at a second servant node.  At step 706, manager server 30 receives and aggregates first and second packet
flow 70a and 70b, respectively, into a third packet flow 70c based on source address, destination address, priority, or any other suitable criteria.  Manager server 30 then dynamically processes aggregated third packet flow 70c to detect if third packet
flow 70 represents a multi-stage or multi-port attack on internal network 80.  Manager server 30 may process third packet flow 70c according to any suitable intrusion detection techniques.  If an attack is not detected at decisional step 709, then
execution ends.  Otherwise, execution proceeds to step 710 where manager server 30 automatically generates a response message 72 in response to the attack detected in the processing at step 708.  At step 712, manager server 30 associates a generation
date with the generated response message 72.  Generally, this generation date will allow a system 10 to discard older response messages 72.
<BR><BR> Once response message 72 has been dynamically generated, manager server 30 distributes the new response message 72 to all appropriate lower nodes and to the upper levels in the system 10 hierarchy in steps 714 through 722.  If one or more of the
servant nodes is a sensor 20 at decisional step 714, then manager server 30 automatically communicates response message 72 to the appropriate response message file 25 for sensor 20.  At step 718, manager server 30 communicates a processing message 73 to
sensor 20 in order that sensor 20 appropriately receives and utilizes response message 72.  Manager server 30 automatically communicates response message 72 to all the remaining servant nodes which may include other manager server servers 30 in step 720. At step 722, manager server 30 automatically communicates response message 72 to the upper levels in a system 10 hierarchy.  It should be understood that one or more of these upper-level manager servers 30 may distribute the newly generated response
message 72 to any respective lower nodes as appropriate.
<BR><BR> FIG. 8 is a flow chart illustrating a method 800 for generating a user interface using sorted packet flows 70 for use by graphical user interface (GUI) 52.  Generally, method 800 provides GUI 52 with a user-friendly, graphically efficient view
of the vast amounts of data received across the enterprise and processed by system 10.  While method 800 is described using global server 40, it will be understood that any appropriate module in system 10 may be used.  Further, any other suitable system
may use method 800 without departing from the scope of this disclosure.
<BR><BR> Method 800 begins at step 802 where global server 40 receives a plurality of packet flows 70 from all lower nodes in system 10.  Global server 40 generates a hash table 75 based on the received packet flows 70, as described in more detail in
FIG. 5.  At step 806, global server 40 sorts hash table 75 using any appropriate criteria.  Global server 40 then generates a parent HTML page for presentation to the console 50 via GUI 52 in step 808.  Execution then proceeds to steps 810 through 826,
where global server 40 generates the links for child HTML pages for the various packet flow 70 received at global server 40.
<BR><BR> At step 810, global server 40 retrieves the first hash value 76 in the sorted hash table 75.  Global server 40 uses the retrieved hash value 76 to retrieve the associated packet flow 70 in the array 77 at step 812.  At step 814, global server 40
extracts the source address, destination address, and determines the number of packets for packet flow 70.  Once this information is extracted, global server 40 generates a link on the parent HTML page for the respective packet flow 70.  At step 818,
global server 40 may alternate the color of the link based on the priority assigned to the respective packet flow 70.  Global server 40 then generates a child HTML file or page for packet flow 70.  At step 822 the extracted data is stored in the child
HTML page.  Global server 40 then stores the packet flow 70 payloads in the child HTML file.  At decisional step 826, global server 40 determines if there are more hash values 76 in hash table 75.  If there are more hash values 76 in hash table 75, then
execution returns to step 812 and generates a new link in child HTML page for the new associated packet flow 70.  Otherwise, if all the desired hash values 76 have been processed, then execution ends.
<BR><BR> The preceding flowcharts focus on the operation of example vertically extensible <B><I>intrusion detection system</I></B> 10 described in FIG. 1, as this diagram illustrates functional elements that provide for the preceding scaleable techniques.  However, as
noted, system 10 contemplates using any suitable combination and arrangement of functional elements for providing these operations, and these techniques can be combined with other techniques as appropriate.  Further, various changes may be made to the
preceding flowcharts without departing from the scope of this disclosure.
<BR><BR> Although the present invention has been described in detail, it should be understood that various changes, substitutions and alterations can be made hereto without departing from the sphere and scope of the invention as defined by the appended
claims.
<BR><BR> To aid the Patent Office, and any readers of any patent issued on this application in interpreting the claims appended hereto, applicants wish to note that they do not intend any of the appended claims to invoke 6 of 35 U.S.C.  .sctn.  112 as it
exists on the date of filing hereof unless "means for" or "step for" are used in the particular claim.
<BR><BR><CENTER><b>* * * * *</b></CENTER>
<HR>
   <CENTER>
   <a href=http://pdfpiw.uspto.gov/.piw?Docid=07356585&homeurl=http%3A%2F%2Fpatft.uspto.gov%2Fnetacgi%2Fnph-Parser%3FSect1%3DPTO2%2526Sect2%3DHITOFF%2526u%3D%25252Fnetahtml%25252FPTO%25252Fsearch-adv.htm%2526r%3D967%2526f%3DG%2526l%3D50%2526d%3DPTXT%2526s1%3D((G06F.CPCL.%252BAND%252B(%252522intrusion%252Bprevention%252Bsystem%252522%252BOR%252B%252522intrusion%252Bdetection%252Bsystem%252522))%252BAND%252B((power%252BOR%252Belectricity)%252BOR%252Brelay))%2526p%3D20%2526OS%3DCPCL%2FG06F%252BAND%252B(%252522intrusion%252Bprevention%252Bsystem%252522%252BOR%252B%252522intrusion%252Bdetection%252Bsystem%252522)%252BAND%252B(power%252Bor%252Belectricity%252Bor%252Brelay)%2526RS%3D((CPCL%2FG06F%252BAND%252B(%252522intrusion%252Bprevention%252Bsystem%252522%252BOR%252B%252522intrusion%252Bdetection%252Bsystem%252522))%252BAND%252B((power%252BOR%252Belectricity)%252BOR%252Brelay))&PageNum=&Rtype=&SectionNum=&idkey=NONE&Input=View+first+page><img src="/netaicon/PTO/image.gif" alt="[Image]" border="0" valign="middle"></A>
   <TABLE>
   <TR><TD align="center"><A href="https://certifiedcopycenter.uspto.gov/other/patft/view.html?backUrl1=http%3A//patft.uspto.gov/netacgi/nph-Parser?Sect1%3DPTO2%26Sect2%3DHITOFF%26u%3D%25252Fnetahtml%25252FPTO%25252Fsearch-adv.htm%26r%3D967%26f%3DG%26l%3D50%26d%3DPTXT%26s1%3D((G06F.CPCL.%252BAND%252B(%252522intrusion%252Bprevention%252Bsystem%252522%252BOR%252B%252522intrusion%252Bdetection%252Bsystem%252522))%252BAND%252B((power%252BOR%252Belectricity)%252BOR%252Brelay))%26p%3D20%26OS%3DCPCL%2FG06F%252BAND%252B(%252522intrusion%252Bprevention%252Bsystem%252522%252BOR%252B%252522intrusion%252Bdetection%252Bsystem%252522)%252BAND%252B(power%252Bor%252Belectricity%252Bor%252Brelay)&backLabel1=Back%20to%20Document%3A%207356585"><IMG border="0" src="/netaicon/PTO/cart.gif" border="0" valign="m
iddle" alt="[View Shopping Cart]"></A>
   <A href="https://certifiedcopycenter.uspto.gov/other/patft/order.html?docNumber=7356585&backUrl1=http%3A//patft.uspto.gov/netacgi/nph-Parser?Sect1%3DPTO2%26Sect2%3DHITOFF%26u%3D%25252Fnetahtml%25252FPTO%25252Fsearch-adv.htm%26r%3D967%26f%3DG%26l%3D50%26d%3DPTXT%26s1%3D((G06F.CPCL.%252BAND%252B(%252522intrusion%252Bprevention%252Bsystem%252522%252BOR%252B%252522intrusion%252Bdetection%252Bsystem%252522))%252BAND%252B((power%252BOR%252Belectricity)%252BOR%252Brelay))%26p%3D20%26OS%3DCPCL%2FG06F%252BAND%252B(%252522intrusion%252Bprevention%252Bsystem%252522%252BOR%252B%252522intrusion%252Bdetection%252Bsystem%252522)%252BAND%252B(power%252Bor%252Belectricity%252Bor%252Brelay)&backLabel1=Back%20to%20Document%3A%207356585">
   <IMG border="0" src="/netaicon/PTO/order.gif" valign="middle" alt="[Add to Shopping Cart]"></A>
   </TD></TR>
   <TR><TD align="center">
     <A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=967&f=S&l=50&d=PTXT&s1=((G06F.CPCL.+AND+(%22intrusion+prevention+system%22+OR+%22intrusion+detection+system%22))+AND+((power+OR+electricity)+OR+relay))&p=19&Query=CPCL/G06F+AND+(&quot;intrusion+prevention+system&quot;+OR+&quot;intrusion+detection+system&quot;)+AND+(power+or+electricity+or+relay)><IMG VALIGN=MIDDLE SRC=/netaicon/PTO/prevlist.gif border=0 ALT=[PREV_LIST]></A>
<A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=967&f=S&l=50&d=PTXT&s1=((G06F.CPCL.+AND+(%22intrusion+prevention+system%22+OR+%22intrusion+detection+system%22))+AND+((power+OR+electricity)+OR+relay))&p=20&Query=CPCL/G06F+AND+(&quot;intrusion+prevention+system&quot;+OR+&quot;intrusion+detection+system&quot;)+AND+(power+or+electricity+or+relay)><IMG VALIGN=MIDDLE SRC=/netaicon/PTO/hitlist.gif border=0 ALT=[HIT_LIST]></A>
<A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=967&f=S&l=50&d=PTXT&s1=((G06F.CPCL.+AND+(%22intrusion+prevention+system%22+OR+%22intrusion+detection+system%22))+AND+((power+OR+electricity)+OR+relay))&p=21&Query=CPCL/G06F+AND+(&quot;intrusion+prevention+system&quot;+OR+&quot;intrusion+detection+system&quot;)+AND+(power+or+electricity+or+relay)><IMG VALIGN=MIDDLE SRC=/netaicon/PTO/nextlist.gif border=0 ALT=[NEXT_LIST]></A>
<A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=966&f=G&l=50&d=PTXT&s1=((G06F.CPCL.+AND+(%22intrusion+prevention+system%22+OR+%22intrusion+detection+system%22))+AND+((power+OR+electricity)+OR+relay))&p=20&OS=CPCL/G06F+AND+(&quot;intrusion+prevention+system&quot;+OR+&quot;intrusion+detection+system&quot;)+AND+(power+or+electricity+or+relay)><IMG VALIGN=MIDDLE SRC=/netaicon/PTO/prevdoc.gif border=0 ALT=[PREV_DOC]></A>
<A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=968&f=G&l=50&d=PTXT&s1=((G06F.CPCL.+AND+(%22intrusion+prevention+system%22+OR+%22intrusion+detection+system%22))+AND+((power+OR+electricity)+OR+relay))&p=20&OS=CPCL/G06F+AND+(&quot;intrusion+prevention+system&quot;+OR+&quot;intrusion+detection+system&quot;)+AND+(power+or+electricity+or+relay)><IMG VALIGN=MIDDLE SRC=/netaicon/PTO/nextdoc.gif border=0 ALT=[NEXT_DOC]></A>

   <A href="#top"><IMG valign="middle" src="/netaicon/PTO/top.gif" border="0" alt="[Top]"></A>
   </TD></TR>
   </TABLE>
   <A name="bottom"></A>
   <A href="/netahtml/PTO/index.html"><IMG src="/netaicon/PTO/home.gif" alt="[Home]" border="0" valign="middle"></A>
   <A href="/netahtml/PTO/search-bool.html"><IMG src="/netaicon/PTO/boolean.gif" alt="[Boolean Search]" border="0" valign="middle"></A>
   <A href="/netahtml/PTO/search-adv.htm"><IMG border="0" src="/netaicon/PTO/manual.gif" alt="[Manual Search]" valign="middle"></A>
   <A href="/netahtml/PTO/srchnum.htm"><IMG src="/netaicon/PTO/number.gif" alt="[Number Search]" border="0" valign="middle"></A>
   <A href="/netahtml/PTO/help/help.htm"><IMG border="0" src="/netaicon/PTO/help.gif" alt="[Help]" valign="middle"></A>
   </CENTER>
</BODY>
</HTML>