<HTML>
<HEAD>
<BASE target="_top">
<TITLE>United States Patent: 8266267</TITLE></HEAD>
<!-BUF1=8266267
BUF7=2012
BUF8=73474
BUF9=/1/
BUF51=8
-->
<BODY bgcolor="#FFFFFF">
<A name="top"></A>
<CENTER>
<IMG src="/netaicon/PTO/patfthdr.gif" alt="[US Patent & Trademark Office, Patent Full Text and Image Database]">
<BR>
<TABLE>
<TR><TD align="center">
<A href="/netahtml/PTO/index.html"><IMG src="/netaicon/PTO/home.gif" alt="[Home]" border="0" valign="middle"></A>
<A href="/netahtml/PTO/search-bool.html"><IMG src="/netaicon/PTO/boolean.gif" alt="[Boolean Search]" border="0" valign="middle"></A>
<A href="/netahtml/PTO/search-adv.htm"><IMG border="0" src="/netaicon/PTO/manual.gif" ALT="[Manual Search]" valign="middle"></A>
<A href="/netahtml/PTO/srchnum.htm"><IMG src="/netaicon/PTO/number.gif" alt="[Number Search]" border="0" valign="middle"></A>
<A href="/netahtml/PTO/help/help.htm"><IMG border="0" valign="middle" src="/netaicon/PTO/help.gif" ALT="[Help]"></A>
</TD></TR>
<TR><TD align="center">
   <A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=834&f=S&l=50&d=PTXT&s1=((G06F.CPCL.+AND+(%22intrusion+prevention+system%22+OR+%22intrusion+detection+system%22))+AND+((power+OR+electricity)+OR+relay))&p=16&Query=CPCL/G06F+AND+(&quot;intrusion+prevention+system&quot;+OR+&quot;intrusion+detection+system&quot;)+AND+(power+or+electricity+or+relay)><IMG VALIGN=MIDDLE SRC=/netaicon/PTO/prevlist.gif border=0 ALT=[PREV_LIST]></A>
<A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=834&f=S&l=50&d=PTXT&s1=((G06F.CPCL.+AND+(%22intrusion+prevention+system%22+OR+%22intrusion+detection+system%22))+AND+((power+OR+electricity)+OR+relay))&p=17&Query=CPCL/G06F+AND+(&quot;intrusion+prevention+system&quot;+OR+&quot;intrusion+detection+system&quot;)+AND+(power+or+electricity+or+relay)><IMG VALIGN=MIDDLE SRC=/netaicon/PTO/hitlist.gif border=0 ALT=[HIT_LIST]></A>
<A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=834&f=S&l=50&d=PTXT&s1=((G06F.CPCL.+AND+(%22intrusion+prevention+system%22+OR+%22intrusion+detection+system%22))+AND+((power+OR+electricity)+OR+relay))&p=18&Query=CPCL/G06F+AND+(&quot;intrusion+prevention+system&quot;+OR+&quot;intrusion+detection+system&quot;)+AND+(power+or+electricity+or+relay)><IMG VALIGN=MIDDLE SRC=/netaicon/PTO/nextlist.gif border=0 ALT=[NEXT_LIST]></A>
<A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=833&f=G&l=50&d=PTXT&s1=((G06F.CPCL.+AND+(%22intrusion+prevention+system%22+OR+%22intrusion+detection+system%22))+AND+((power+OR+electricity)+OR+relay))&p=17&OS=CPCL/G06F+AND+(&quot;intrusion+prevention+system&quot;+OR+&quot;intrusion+detection+system&quot;)+AND+(power+or+electricity+or+relay)><IMG VALIGN=MIDDLE SRC=/netaicon/PTO/prevdoc.gif border=0 ALT=[PREV_DOC]></A>
<A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=835&f=G&l=50&d=PTXT&s1=((G06F.CPCL.+AND+(%22intrusion+prevention+system%22+OR+%22intrusion+detection+system%22))+AND+((power+OR+electricity)+OR+relay))&p=17&OS=CPCL/G06F+AND+(&quot;intrusion+prevention+system&quot;+OR+&quot;intrusion+detection+system&quot;)+AND+(power+or+electricity+or+relay)><IMG VALIGN=MIDDLE SRC=/netaicon/PTO/nextdoc.gif border=0 ALT=[NEXT_DOC]></A>

<A href="#bottom"><IMG src="/netaicon/PTO/bottom.gif" alt="[Bottom]" valign="middle" border="0"></A>
</TD></TR>
   <TR><TD align="center">
   <A href="https://certifiedcopycenter.uspto.gov/other/patft/view.html?backUrl1=http%3A//patft.uspto.gov/netacgi/nph-Parser?Sect1%3DPTO2%26Sect2%3DHITOFF%26u%3D%25252Fnetahtml%25252FPTO%25252Fsearch-adv.htm%26r%3D834%26f%3DG%26l%3D50%26d%3DPTXT%26s1%3D((G06F.CPCL.%252BAND%252B(%252522intrusion%252Bprevention%252Bsystem%252522%252BOR%252B%252522intrusion%252Bdetection%252Bsystem%252522))%252BAND%252B((power%252BOR%252Belectricity)%252BOR%252Brelay))%26p%3D17%26OS%3DCPCL%2FG06F%252BAND%252B(%252522intrusion%252Bprevention%252Bsystem%252522%252BOR%252B%252522intrusion%252Bdetection%252Bsystem%252522)%252BAND%252B(power%252Bor%252Belectricity%252Bor%252Brelay)&backLabel1=Back%20to%20Document%3A%208266267"><IMG border="0" src="/netaicon/PTO/cart.gif" border="0" valign="middle" alt="[View Shopp
ing Cart]"></A>
   <A href="https://certifiedcopycenter.uspto.gov/other/patft/order.html?docNumber=8266267&backUrl1=http%3A//patft.uspto.gov/netacgi/nph-Parser?Sect1%3DPTO2%26Sect2%3DHITOFF%26u%3D%25252Fnetahtml%25252FPTO%25252Fsearch-adv.htm%26r%3D834%26f%3DG%26l%3D50%26d%3DPTXT%26s1%3D((G06F.CPCL.%252BAND%252B(%252522intrusion%252Bprevention%252Bsystem%252522%252BOR%252B%252522intrusion%252Bdetection%252Bsystem%252522))%252BAND%252B((power%252BOR%252Belectricity)%252BOR%252Brelay))%26p%3D17%26OS%3DCPCL%2FG06F%252BAND%252B(%252522intrusion%252Bprevention%252Bsystem%252522%252BOR%252B%252522intrusion%252Bdetection%252Bsystem%252522)%252BAND%252B(power%252Bor%252Belectricity%252Bor%252Brelay)&backLabel1=Back%20to%20Document%3A%208266267">
   <IMG border="0" src="/netaicon/PTO/order.gif" valign="middle" alt="[Add to Shopping Cart]"></A>
   </TD></TR>
   <TR><TD align="center">
   <a href=http://pdfpiw.uspto.gov/.piw?Docid=08266267&homeurl=http%3A%2F%2Fpatft.uspto.gov%2Fnetacgi%2Fnph-Parser%3FSect1%3DPTO2%2526Sect2%3DHITOFF%2526u%3D%25252Fnetahtml%25252FPTO%25252Fsearch-adv.htm%2526r%3D834%2526f%3DG%2526l%3D50%2526d%3DPTXT%2526s1%3D((G06F.CPCL.%252BAND%252B(%252522intrusion%252Bprevention%252Bsystem%252522%252BOR%252B%252522intrusion%252Bdetection%252Bsystem%252522))%252BAND%252B((power%252BOR%252Belectricity)%252BOR%252Brelay))%2526p%3D17%2526OS%3DCPCL%2FG06F%252BAND%252B(%252522intrusion%252Bprevention%252Bsystem%252522%252BOR%252B%252522intrusion%252Bdetection%252Bsystem%252522)%252BAND%252B(power%252Bor%252Belectricity%252Bor%252Brelay)%2526RS%3D((CPCL%2FG06F%252BAND%252B(%252522intrusion%252Bprevention%252Bsystem%252522%252BOR%252B%252522intrusion%252Bdetection%252Bsystem%252522))%252BAND%252B((power%252BOR%252Belectricity)%252BOR%252Brelay))&PageNum=&Rtype=&SectionNum=&idkey=NONE&Input=View+first+page><img src="/netaicon/PTO/image.gif" alt="[Image]" border="0" valign="middle"></A>

   </TD></TR>
</TABLE>
</CENTER>
<TABLE width="100%">
<TR><TD align="left" width="50%">&nbsp;</TD>
<TD align="right" valign="bottom" width="50%"><FONT size="-1">( <STRONG>834</STRONG></FONT> <FONT size=-2>of</FONT> <STRONG><FONT size=-1>1029</STRONG> )</FONT></TD></TR></TABLE>
<HR>
   <TABLE width="100%">
   <TR>	<TD align="left" width="50%"><b>United States Patent </b></TD>
   <TD align="right" width="50%"><b>8,266,267</b></TD>
   </TR>
     <TR><TD align="left" width="50%"><b>
         Guruswamy
, &nbsp; et al.</b>
     </TD>
     <TD align="right" width="50%"> <b>
     September 11, 2012
</b></TD>
     </TR>
     </TABLE>
       <HR>
       <FONT size="+1">Detection and prevention of encapsulated network attacks using an
     intermediate device
</FONT><BR>
       <BR><CENTER><b>Abstract</b></CENTER>
       <p> A network device is capable of recognizing and blocking network attacks
     associated with packet flows regardless of whether the packet flows are
     encapsulated within network tunnels. For example, the network device
     includes a filter module that receives packets associated with a network
     tunnel from an ingress device to an egress device. The filter module
     applies heuristics to determine whether the packets encapsulate encrypted
     data units. If the data units are not encrypted, the filter module
     extracts the data units and generates temporary packets for use within
     the network device. An attack detection engine within the device analyzes
     the temporary packets to detect any network attacks carried by the
     encapsulated data units. A forwarding component selectively forwards the
     packets to the egress device based on whether any network attacks are
     detected.
</p>
       <HR>
<TABLE width="100%"> <TR> <TH scope="row" valign="top" align="left" width="10%">Inventors:</TH> <TD align="left" width="90%">
 <B>Guruswamy; Kowsik</B> (Sunnyvale, CA)<B>, Yang; Siyang</B> (Milpitas, CA) </TD> </TR>
<TR> <TH scope="row" valign="top" align="left" width="10%">Assignee:</TH>
<TD align="left" width="90%">

<B>Juniper Networks, Inc.</B>
 (Sunnyvale, 
CA)
<BR>

</TD>
</TR>
       <TR><TH scope="row" valign="top" align="left" width="10%" nowrap>Family ID:
       </TD><TD align="left" width="90%">
       <b>42711076
</b></TD></TR>
       <TR><TH scope="row" valign="top" align="left" width="10%" nowrap>Appl. No.:
       </TH><TD align="left" width="90%">
       <b>12/869,478</b></TD></TR>
       <TR><TH scope="row" valign="top" align="left" width="10%">Filed:
       </TH><TD align="left" width="90%">
       <b>August 26, 2010</b></TD></TR>
     </TABLE>
<HR> <CENTER><b>Related U.S. Patent Documents</b></CENTER> <HR> <TABLE width="100%"> <TR><TH scope="col" width="7%"></TH><TH scope="col"></TH><TH scope="col"></TH> <TH scope="col"></TH><TH scope="col"></TH><TD></TD></TR> <TR><TD align="left">
</TD><TH scope='col' align=center><B><U>Application Number</U></B></TH><TH scope='col' align=center><B><U>Filing Date</U></B></TH><TH scope='col' align=center><B><U>Patent Number</U></B></TH><TH scope='col' align=center><B><U>Issue Date</U></B></TH><TD</TD></TR><TR><TD align=center> </TD><TD align=center>11049620</TD><TD align=center>Feb 2, 2005</TD><TD align=center>7797411</TD><TD align=center></TD><TD</TD></TR><TR><TD align=center> 
</TD>
</TR> </TABLE>     <HR>
<p> <TABLE width="100%"> <TR><TD valign="top" align="left" width="30%"><b>Current U.S. Class:</b></TD> <TD valign="top" align="right" width="70%"><b>709/223</b>; 709/229; 370/229 </TD></TR> 
       <TR><TD valign="top" align="left" width="30%"><b>Current CPC Class: </b></TD>
       <TD valign="top" align="right" width="70%">G06F 15/173&nbsp(20130101); H04L 63/1441&nbsp(20130101); H04L 63/1425&nbsp(20130101)</TD></TR>
         <TR><TD valign="top" align="left" width="30%"><b>Current International Class: </b></TD>
         <TD valign="top" align="right" width="70%">G06F 15/173&nbsp(20060101); G06F 15/16&nbsp(20060101); G06F 11/00&nbsp(20060101)</TD></TR>
       <TR><TD valign="top" align="left" width="30%"><b>Field of Search: </b></TD>
       <TD align="right" valign="top" width="70%">
       










 ;709/223,229 ;713/150-154 ;726/2-4,11-14,22,23 ;370/229,235,357,395.5
       </TD></TR>
     </TABLE>
<HR><CENTER><b>References Cited  <A href="/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2Fsearch-adv.htm&r=0&f=S&l=50&d=PALL&Query=ref/8266267">[Referenced By]</A></b></CENTER>       <HR>
       <CENTER><b>U.S. Patent Documents</b></CENTER>
<TABLE width="100%"> <TR><TH scope="col" width="33%"></TH> <TH scope="col" width="33%"></TH> <TH scope="col" width="34%"></TH></TR> <TR> <TD align="left">
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F5787253">5787253</a></TD><TD align =left>
July 1998</TD><TD align=left>
McCreery et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F6154775">6154775</a></TD><TD align =left>
November 2000</TD><TD align=left>
Coss et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F6219786">6219786</a></TD><TD align =left>
April 2001</TD><TD align=left>
Cunningham et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F6279113">6279113</a></TD><TD align =left>
August 2001</TD><TD align=left>
Vaidya</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F6301668">6301668</a></TD><TD align =left>
October 2001</TD><TD align=left>
Gleichauf et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F6499107">6499107</a></TD><TD align =left>
December 2002</TD><TD align=left>
Gleichauf et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F6507834">6507834</a></TD><TD align =left>
January 2003</TD><TD align=left>
Kabra et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F6751728">6751728</a></TD><TD align =left>
June 2004</TD><TD align=left>
Gunter et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F6772345">6772345</a></TD><TD align =left>
August 2004</TD><TD align=left>
Shetty</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F6789116">6789116</a></TD><TD align =left>
September 2004</TD><TD align=left>
Sarkissian et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F6845452">6845452</a></TD><TD align =left>
January 2005</TD><TD align=left>
Roddy et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F6918034">6918034</a></TD><TD align =left>
July 2005</TD><TD align=left>
Sengodan et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F6954775">6954775</a></TD><TD align =left>
October 2005</TD><TD align=left>
Shanklin et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7007301">7007301</a></TD><TD align =left>
February 2006</TD><TD align=left>
Crosbie et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7016980">7016980</a></TD><TD align =left>
March 2006</TD><TD align=left>
Mayer et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7017186">7017186</a></TD><TD align =left>
March 2006</TD><TD align=left>
Day</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7065657">7065657</a></TD><TD align =left>
June 2006</TD><TD align=left>
Moran</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7076803">7076803</a></TD><TD align =left>
July 2006</TD><TD align=left>
Bruton, III et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7089428">7089428</a></TD><TD align =left>
August 2006</TD><TD align=left>
Farley et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7100201">7100201</a></TD><TD align =left>
August 2006</TD><TD align=left>
Izatt</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7174566">7174566</a></TD><TD align =left>
February 2007</TD><TD align=left>
Yadav</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7222366">7222366</a></TD><TD align =left>
May 2007</TD><TD align=left>
Bruton et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7234168">7234168</a></TD><TD align =left>
June 2007</TD><TD align=left>
Gupta et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7240368">7240368</a></TD><TD align =left>
July 2007</TD><TD align=left>
Roesch et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7277404">7277404</a></TD><TD align =left>
October 2007</TD><TD align=left>
Tanzella et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7308715">7308715</a></TD><TD align =left>
December 2007</TD><TD align=left>
Gupta et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7320142">7320142</a></TD><TD align =left>
January 2008</TD><TD align=left>
Kasper et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7322044">7322044</a></TD><TD align =left>
January 2008</TD><TD align=left>
Hrastar</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7324447">7324447</a></TD><TD align =left>
January 2008</TD><TD align=left>
Morford</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7324804">7324804</a></TD><TD align =left>
January 2008</TD><TD align=left>
Hrastar et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7331061">7331061</a></TD><TD align =left>
February 2008</TD><TD align=left>
Ramsey et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7383577">7383577</a></TD><TD align =left>
June 2008</TD><TD align=left>
Hrastar et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7424744">7424744</a></TD><TD align =left>
September 2008</TD><TD align=left>
Wu et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7441267">7441267</a></TD><TD align =left>
October 2008</TD><TD align=left>
Elliott</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7509380">7509380</a></TD><TD align =left>
March 2009</TD><TD align=left>
Motoyama</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7526541">7526541</a></TD><TD align =left>
April 2009</TD><TD align=left>
Roese et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7769851">7769851</a></TD><TD align =left>
August 2010</TD><TD align=left>
Guruswamy et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7797411">7797411</a></TD><TD align =left>
September 2010</TD><TD align=left>
Guruswamy et al.</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7809926">7809926</a></TD><TD align =left>
October 2010</TD><TD align=left>
Guruswamy</TD></TR><TR><TD align=left>
<a href="/netacgi/nph-Parser?Sect2=PTO1&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&d=PALL&RefSrch=yes&Query=PN%2F7810151">7810151</a></TD><TD align =left>
October 2010</TD><TD align=left>
Guruswamy</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20020046275&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2002/0046275</a></TD><TD align =left>
April 2002</TD><TD align=left>
Crosbie et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20020053033&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2002/0053033</a></TD><TD align =left>
May 2002</TD><TD align=left>
Cooper et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20020055998&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2002/0055998</a></TD><TD align =left>
May 2002</TD><TD align=left>
Riddle et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20020078370&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2002/0078370</a></TD><TD align =left>
June 2002</TD><TD align=left>
Tahan</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20020124187&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2002/0124187</a></TD><TD align =left>
September 2002</TD><TD align=left>
Lyle et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20020143939&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2002/0143939</a></TD><TD align =left>
October 2002</TD><TD align=left>
Riddle et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20020144156&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2002/0144156</a></TD><TD align =left>
October 2002</TD><TD align=left>
Copeland, III</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20020198981&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2002/0198981</a></TD><TD align =left>
December 2002</TD><TD align=left>
Corl, Jr. et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20030065953&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2003/0065953</a></TD><TD align =left>
April 2003</TD><TD align=left>
Lehmann et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20030084319&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2003/0084319</a></TD><TD align =left>
May 2003</TD><TD align=left>
Tarquini et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20030105976&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2003/0105976</a></TD><TD align =left>
June 2003</TD><TD align=left>
Copeland, III</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20030131263&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2003/0131263</a></TD><TD align =left>
July 2003</TD><TD align=left>
Keane et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20030149766&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2003/0149766</a></TD><TD align =left>
August 2003</TD><TD align=left>
Syvanne et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20030149887&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2003/0149887</a></TD><TD align =left>
August 2003</TD><TD align=left>
Yadav</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20030154399&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2003/0154399</a></TD><TD align =left>
August 2003</TD><TD align=left>
Zuk et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20030182580&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2003/0182580</a></TD><TD align =left>
September 2003</TD><TD align=left>
Lee</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20030204632&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2003/0204632</a></TD><TD align =left>
October 2003</TD><TD align=left>
Willebeek-LeMair et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20030212903&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2003/0212903</a></TD><TD align =left>
November 2003</TD><TD align=left>
Porras et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20030217289&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2003/0217289</a></TD><TD align =left>
November 2003</TD><TD align=left>
Ammon et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20030236990&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2003/0236990</a></TD><TD align =left>
December 2003</TD><TD align=left>
Hrastar et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20040015579&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2004/0015579</a></TD><TD align =left>
January 2004</TD><TD align=left>
Cooper et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20040015719&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2004/0015719</a></TD><TD align =left>
January 2004</TD><TD align=left>
Lee et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20040025044&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2004/0025044</a></TD><TD align =left>
February 2004</TD><TD align=left>
Day</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20040034800&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2004/0034800</a></TD><TD align =left>
February 2004</TD><TD align=left>
Singhal et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20040044912&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2004/0044912</a></TD><TD align =left>
March 2004</TD><TD align=left>
Connary et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20040083299&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2004/0083299</a></TD><TD align =left>
April 2004</TD><TD align=left>
Dietz et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20040098623&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2004/0098623</a></TD><TD align =left>
May 2004</TD><TD align=left>
Scheidell</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20040151382&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2004/0151382</a></TD><TD align =left>
August 2004</TD><TD align=left>
Stellenberg et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20040181690&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2004/0181690</a></TD><TD align =left>
September 2004</TD><TD align=left>
Rothermel et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20040255167&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2004/0255167</a></TD><TD align =left>
December 2004</TD><TD align=left>
Knight</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20040268150&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2004/0268150</a></TD><TD align =left>
December 2004</TD><TD align=left>
Aaron</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20050018618&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2005/0018618</a></TD><TD align =left>
January 2005</TD><TD align=left>
Mualem et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20050044406&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2005/0044406</a></TD><TD align =left>
February 2005</TD><TD align=left>
Stute</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20060095968&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2006/0095968</a></TD><TD align =left>
May 2006</TD><TD align=left>
Portolani et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20060117386&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2006/0117386</a></TD><TD align =left>
June 2006</TD><TD align=left>
Gupta et al.</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20060137009&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2006/0137009</a></TD><TD align =left>
June 2006</TD><TD align=left>
Chesla</TD></TR><TR><TD align=left>
<a href="http://appft.uspto.gov/netacgi/nph-Parser?TERM1=20090064333&Sect1=PTO1&Sect2=HITOFF&d=PG01&p=1&u=%2Fnetahtml%2FPTO%2Fsrchnum.html&r=0&f=S&l=50" target="_blank">2009/0064333</a></TD><TD align =left>
March 2009</TD><TD align=left>
Saurabh et al.</TD></TR><TR><TD align=left>

</TD>
</TR> </TABLE>
<TABLE width="90%"> <BR> <CENTER><b>Other References</b></CENTER> <TR><TD><align="left"><BR>"Norton Internet Security.TM. 2003 User's Guide," 2002, Symantec Corporation. cited by other
.<BR>"Ethereal 0.10.0 has been released," Dec. 12, 2003, www.ethereal.com, retrieved from the Internet Archive WayBackMachine, indexed Jan. 1, 2004. cited by other
.<BR>Campos et al., "Creation and Deployment of Data Mining-Based Intrusion Detection Systems in Oracle Database 10g," in Proceedings of the Fourth International Conference on Machine Learning and Applications, Sep. 2005, 8 pp. cited by other
.<BR>Warshaw et al., "VenusIDS: An Active Database Component for Intrusion Detection," Applied Research Laboratories, Department of Computer Sciences, University of Texas at Austin, Jun. 11, 1999, 12 pp. cited by other
.<BR>Warshaw et al., "Monitoring Network Logs for Anomalous Activity," Applied Research Laboratories, Department of Computer Sciences, University of Texas at Austin, Oct. 9, 1998, 6 pp. cited by other
.<BR>Jain et al., "A Wakeup Call for Internet Monitoring Systems: The Case for Distributed Triggers," 2004, 6 pp. cited by other
.<BR>Brugger, "Data Mining Methods for Network Intrusion Detection," Jun. 9, 2004, 65 pp. cited by other
.<BR>Reflex Security, Reflex <A Name=h1 HREF=#h0></A><A  HREF=#h2></A><B><I>Intrusion Prevention System.</I></B> May 7, 2004, 12 pp. cited by other
.<BR>Reflex Security, Reflex Interceptor 500, Jan. 29, 2004, 2 pp. cited by other
.<BR>Yannakakis, Perspectives on Database Theory, IEEE, Proceedings of 36 Annual Symposium on Foundations of Computer Science, Milwaukee, Wisconsin, Oct. 23-25, 1995, 25 pp. cited by other
.<BR>Roelker, Snort User Manual, HTTP inspect readme, Aug. 11, 2004, see .sctn..sctn. 2.1.7,2.1.8, 2.1.10, 7 pp. cited by other
.<BR>Bitpipe, Reflex Interceptor Management Console Product Description, May 25, 2004, 1 pg. cited by other
.<BR>Reflex Security, Reflex Interceptor Management Console Whitepaper, Jan. 29, 2004, 2 pp. cited by other
.<BR>Wikipedia, Cisco PIX, accessed Apr. 10, 2009, 11 pp. cited by other
.<BR>"Intrusion Detection and Prevention," OneSecure, Inc., 2001, 6 pp. cited by other
.<BR>U.S. Appl. No. 11/045,572, by Kowsik Guruswamy, filed Jan. 27, 2005. cited by other
.<BR>U.S. Appl. No. 11/044,332, by Kowsik Guruswamy, filed Jan. 27, 2005. cited by other. </TD></TR> </TABLE> <BR>
       <i>Primary Examiner:</i> Shaw; Peling
<BR>
       <i>Assistant Examiner:</i> Richardson; Thomas
<BR>
       <i>Attorney, Agent or Firm:</i> <coma>Shumaker & Sieffert, P.A.
<BR>
       <HR>
       <CENTER><b><i>Parent Case Text</b></i></CENTER>
       <HR>
       <BR><BR> This application is a continuation of U.S. application Ser. No.
     11/049,620, filed Feb. 2, 2005, the entire content of which is
     incorporated herein by reference.
         <HR>
<CENTER><b><i>Claims</b></i></CENTER> <HR> <BR><BR>The invention claimed is: <BR><BR> 1.  A method comprising: receiving, with an intermediate device, packets carried within a network tunnel that extends from an ingress device of the network tunnel to an
egress device of the network tunnel, wherein the packets encapsulate data units for transmission along the network tunnel, and wherein the intermediate device is positioned between the ingress device and the egress device along the network tunnel; 
extracting the encapsulated data units from the packets with the intermediate device;  applying a set of heuristics to the data units to determine whether the data units are encrypted;  and based on the determination of whether the data units are
encrypted, generating, with the intermediate device, temporary packets from the data units such that the temporary packets are different from the originally received packets, analyzing the data units of the temporary packets with the intermediate device
to detect a network attack, and selectively transmitting, with the intermediate device, the originally received packets to the egress device based on the analysis of the temporary packets.
<BR><BR> 2.  The method of claim 1, wherein the data units comprise packets or frames.
<BR><BR> 3.  The method of claim 1, wherein the data units conform to a protocol associated with a wireless communication network.
<BR><BR> 4.  The method of claim 1, wherein generating temporary packets comprises pre-pending headers to the data units to form the temporary packets in accordance with a protocol supported by the intermediate device.
<BR><BR> 5.  The method of claim 1, wherein generating temporary packets comprises: buffering a plurality of the data units to form communication frames;  and pre-pending headers to the communication frames to form the temporary packets.
<BR><BR> 6.  The method of claim 1, wherein generating temporary packets comprises: determining a protocol for the data units;  and applying a protocol-specific algorithm to generate the temporary packets from the data units.
<BR><BR> 7.  The method of claim 6, wherein the protocol comprises one of the Transmission Control Protocol (TCP), User Datagram Protocol (UDP), Point-to-Point Protocol (PPP), or Internet Protocol (IP).
<BR><BR> 8.  The method of claim 1, wherein applying a set of heuristics comprises: examining the data units for indicators of a size of payloads within the data units;  determining an actual size for each of the payloads;  comparing the indicators with
the actual size of each of the payloads;  and determining whether the data units are encrypted based on a result of the comparison.
<BR><BR> 9.  The method of claim 8, wherein examining the data units comprises: determining a protocol associated with the data units;  and selecting the indicators from the data units based on the protocol.
<BR><BR> 10.  The method of claim 1, wherein selectively extracting and analyzing comprises: extracting the data units, generating the temporary packets from the data units and analyzing the data units of the temporary packets to detect the network
attack when the data units are unencrypted;  and forwarding the originally received packets without otherwise extracting the data units, generating the temporary packets from the data units and analyzing the data units of the temporary packets when the
data units are encrypted.
<BR><BR> 11.  The method of claim 1, wherein analyzing the data units comprises: processing the data units within the temporary packets with the intermediate network device to identify network elements associated with the data units;  forming
application-layer communications from the data units within the temporary packets;  processing the application-layer communications with protocol-specific decoders to identify application-layer elements;  and applying an attack definition to the network
elements and the application-layer elements to detect the network attack.
<BR><BR> 12.  The method of claim 11, wherein the network elements include low-level network information including at least one of a network host, network peers or a network port associated with the network traffic.
<BR><BR> 13.  The method of claim 11, wherein the application-layer elements comprise named elements that uniquely identify types of the application-layer elements and values for the named elements.
<BR><BR> 14.  The method of claim 13, wherein the named elements for the application-layer communications include at least one of a file name, a user name, a software application name or a name of an attached document.
<BR><BR> 15.  The method of claim 1, wherein selectively transmitting the original packets comprises: discarding the originally received packets upon detecting the network attack within the temporary packets, and forwarding the originally received
packets when the network attack is not detected within the temporary packets.
<BR><BR> 16.  The method of claim 1, wherein the packets comprise tunneled packet that conform to a tunneling protocol and include headers that identify the tunnel, and wherein the encapsulated data units within the packet conform to a protocol different
from the tunneling protocol and have at least one header.
<BR><BR> 17.  The method of claim 1, wherein receiving packets carried within the network tunnel comprises receiving at least one tunneled packet having a header that identifies the tunnel, wherein the header is associated with a tunneling protocol, and
wherein generating the temporary packets comprises: removing the header from the tunneled packet with the intermediate device;  pre-pending a new header to form a non-tunneled temporary packet with the intermediate device, wherein the new header is
associated with a protocol other than the tunneling protocol, and wherein analyzing the data units comprises analyzing the non-tunneled temporary packet with the intermediate device to detect the network attack.
<BR><BR> 18.  A network device comprising: one or more processors;  a filter module executed by the one or more processors to receive packets carried within a network tunnel that extends from an ingress device of the network tunnel to an egress device of
the network tunnel, wherein the filter module extracts data units encapsulated within the packets for transmission along the network tunnel, wherein the intermediate device is between the ingress device and the egress device along the network tunnel,
wherein the filter module includes a packet generation module to generate temporary packets form the data units such that the temporary packets are different from the originally received packets, an encryption detection module that applies a set of
heuristics to the data units to determine whether the data units are encrypted and a data unit extraction module to extract the data units from the packets when the data units are unencrypted;  an attack detection engine executed by the one or more
processors to analyze the data units of the temporary packets determined to be unencrypted to detect a network attack;  and a forwarding component to selectively forward the originally received packets to the egress device based on the analysis of the
data units of the temporary packets determined to be unencrypted.
<BR><BR> 19.  The network device of claim 18, wherein the data units comprise packets, frames or cells.
<BR><BR> 20.  The network device of claim 18, wherein the data units conform to a protocol associated with a wireless communication network.
<BR><BR> 21.  The network device of claim 18, wherein the packet generation module pre-pends headers to the data units to form the temporary packets in accordance with a protocol supported by the attack detection engine.
<BR><BR> 22.  The network device of claim 18, wherein the packet generation module buffers the data units to form communication frames that span one or more of the packets, and wherein the packet generation module pre-pends headers to the communication
frames to form the temporary packets.
<BR><BR> 23.  The network device of claim 18, wherein the packet generation module determines a protocol for the data units, and applies a protocol-specific algorithm to extract the data units and generate the temporary packets from the data units based
on the determined protocol.
<BR><BR> 24.  The network device of claim 23, wherein the protocol comprises one of Transmission Control Protocol (TCP), User Datagram Protocol (UDP), Point-to-Point Protocol (PPP), or Internet Protocol (IP).
<BR><BR> 25.  The network device of claim 18, wherein the encryption detection module examines the data units to determine indicators of a size of payloads within the data units and compares the indicators with an actual size for each of the payloads; 
and wherein the data unit extraction module extracts the data units based on the result of the comparison.
<BR><BR> 26.  The network device of claim 18, wherein the forwarding component includes a routing table storing routes for a network.
<BR><BR> 27.  The network device of claim 18, wherein the network device comprises a router or a firewall.
<BR><BR> 28.  A non-transitory computer-readable medium comprising instructions that cause a programmable processor within an intermediate network device to: present a user interface that receives input specifying an attack definition;  and configure a
forwarding plane of the network device to receive packets associated with a network tunnel having an ingress device, generate temporary packets from data units encapsulated within the originally received packets such that the temporary packets are
different from the originally received packets, apply a set of heuristics to the data units to determine whether the data units are unencrypted, and, based on the determination of whether the data units are unencrypted, apply the attack definition to the
data units of the temporary packets to detect a network attack, and forward the originally received packets to an egress device of the tunnel based on the application of the attack definition to the data units of the temporary packets determined to be
unencrypted, wherein the intermediate network device is positioned between the ingress device of the network tunnel and the egress device of the network tunnel.
<BR><BR> 29.  The non-transitory computer-readable medium of claim 28, further comprising instructions to cause the processor to selectively forward the packets based on whether the network attack is detected. <HR>
<CENTER><b><i>Description</b></i></CENTER> <HR> <BR><BR>TECHNICAL FIELD
<BR><BR> The invention relates to computer networks and, more particularly, to detection and prevention of attacks within computer networks.
<BR><BR>BACKGROUND
<BR><BR> A computer network is a collection of interconnected computing devices that can exchange data and share resources.  In a packet-based network, the computing devices communicate data by dividing the data into small blocks called packets, which
are individually routed across the network from a source device to a destination device.  The destination device extracts the data from the packets and assembles the data into its original form.  Dividing the data into packets enables the source device
to resend only those individual packets that may be lost during transmission.
<BR><BR> A local network is a collection of interconnected computing devices serving a specific area, such as a business enterprise or office.  Such local networks are often connected to an external public network, such as the Internet.  Access to the
public network comes with certain risks.  For example, malicious users on the external network may pretend to be trustworthy and attempt to access the local network.  In addition, malicious users may launch network attacks in an attempt disrupt the
operation of devices on the local network.
<BR><BR> To prevent such attacks, network administrators use various devices and techniques to restrict or monitor electronic traffic flowing between the public network and the local network.  A firewall, for example, may be used to block packets
addressed to certain computers and prevent unauthorized access to the local network.  Other devices may be used to passively monitor traffic for suspicious behavior.
<BR><BR> In some instances, the public network may be used as an intermediate network to transport encapsulated packets from a source device to a destination device within the local network.  For example, the source device may establish a network
"tunnel" to carry encapsulated packets to the destination device.  Often packets or other data units that conform to one type of protocol are encapsulated within packets of another type of protocol (i.e., the tunneling protocol).  In other words, the
packets are transparently communicated through the intermediate public network via the tunnel.  This technique may be especially useful when the intermediate network does not support the encapsulated protocol or when it is desirable to securely
communicate the encapsulated packets through the public network.
<BR><BR> One example of a tunneling protocol is the Generic Routing Encapsulation (GRE) protocol, which is a protocol for encapsulation of an arbitrary network layer protocol over another arbitrary network layer protocol.  Another example is the set of
Internet Protocol Security (IPsec) protocols that make use of cryptographic technology to establish secure network tunnels.  These tunnels allow packets conforming to other network protocols, such as Internet Protocol (IP) packets, to be encapsulated
within encrypted packet streams flowing through the public network.
<BR><BR> The use of tunnels often presents a challenge in terms of network security.  In particular, it is often difficult to detect security threats within the encapsulated packet streams.  For example, often only the tunnel ingress and egress devices
are involved in establishing the tunnel and, therefore, have knowledge of the tunnel and the encapsulation scheme used by the tunnel.  As a result, it is difficult to analyze the encapsulated packets to determine whether the encapsulated packets carry a
network attack.
<BR><BR>SUMMARY
<BR><BR> In general, the invention is directed to techniques for detecting and preventing network attacks.  More specifically, an intrusion detection and prevention (IDP) device is described that is capable of recognizing and blocking network attacks
associated with packet flows regardless of whether the packet flows are encapsulated within network tunnels.
<BR><BR> In one embodiment, a method comprises receiving with an intermediate device packets associated with a network tunnel from an ingress device to an egress device.  The method further comprises extracting encapsulated data units from the packets,
and analyzing the data units to detect a network attack.
<BR><BR> In another embodiment, a network device comprises a filter module, an attack detection engine and a forwarding component.  The filter module receives packets associated with a network tunnel from an ingress device to an egress device.  The
filter module extracts data units encapsulated within the packets.  The attack detection engine analyzes the data units to detect a network attack.  A forwarding component selectively forwards the packets to the egress device based on whether the network
attack is detected.
<BR><BR> In another embodiment, a computer-readable medium comprises instructions that cause a programmable processor within a network device to present a user interface that receives input specifying an attack definition.  The instructions further cause
the network device to configure a forwarding plane of the network device to generate temporary packets from data units encapsulated within packets associated with a network tunnel and apply the attack definition to the temporary packets to detect a
network attack. <BR><BR>BRIEF DESCRIPTION OF THE DRAWINGS
<BR><BR> FIG. 1 is a block diagram illustrating an exemplary computer network in which an intrusion detection and prevention (IDP) device monitors network traffic in accordance with the principles of the invention.
<BR><BR> FIG. 2 is a block diagram illustrating an exemplary embodiment of an IDP device in further detail.
<BR><BR> FIG. 3 illustrates a portion of the IDP device of FIG. 2 in further detail.
<BR><BR> FIG. 4 is a flowchart illustrating exemplary operation of an IDP device in accordance with the principles of this invention.
<BR><BR> FIG. 5 is a block diagram illustrating an exemplary embodiment of a filter module.
<BR><BR> FIGS. 6A and 6B are block diagrams illustrating Internet Protocol (IP) packets encapsulating Encapsulated Security Payload (ESP) packets for Internet Protocol Security (IPsec) tunneling.
<BR><BR> FIG. 7 is a flowchart showing an exemplary operation of the IDP device when determining whether an IPsec/ESP packet is encrypted.
<BR><BR> FIG. 8 is a block diagram illustrating creation of a temporary packet from an IP packet encapsulating an ESP packet.
<BR><BR> FIGS. 9A and 9B are block diagrams illustrating exemplary IP packets encapsulating two different types of Generic Routing Encapsulation (GRE) packets.
<BR><BR> FIG. 10 is a flowchart showing an example procedure for extraction of packet information from an IP packet carrying a Point-to-Point Protocol (PPP) payload.
<BR><BR>DETAILED DESCRIPTION
<BR><BR> FIG. 1 is a block diagram illustrating an exemplary system 2 in which enterprise 4 includes a private enterprise computing network 5 that is coupled to public network 6, such as the Internet.  Firewall 9 protects enterprise network 5 and, in
particular, internal computing nodes 8A-8N.  Computing nodes 8A-8N ("computing nodes 8") represent any private computing device within enterprise network 5, including workstations, file servers, print servers, database servers, printers and other
devices.
<BR><BR> In addition, firewall 9 may provide a "demilitarized zone" (DMZ) 7, which represents a semi-private area of enterprise network 5 that supports limited access by public network 6 via specific communication protocols.  For example, client devices
(not shown) within public network 6 may have limited access to nodes 15A-15M via the hypertext transport protocol (HTTP) or the file transfer protocol (FTP).
<BR><BR> In the example of FIG. 1, enterprise network 5 includes intrusion detection and prevention (IDP) device 10 that monitors traffic flowing between firewall 9 and internal computing nodes 8.  IDP device 10 analyzes the network traffic to detect
network attacks.
<BR><BR> In general, IDP device 10 identifies packet flows in the monitored traffic, and transparently reassembles application-layer communications from the packet flows.  A set of protocol-specific decoders within the IDP device 10 analyzes the
application-layer communications and identifies application-layer transactions.  In general, a "transaction" refers to a bounded series of related application-layer communications between peer devices.  For example, a single TCP connection can be used to
send (receive) multiple HyperText Transfer Protocol (HTTP) requests (responses).  As one example, a single web page comprising multiple images and links to html pages may be fetched using a single TCP connection.  An HTTP decoder identifies each
request/response within the TCP connection as a different transaction.
<BR><BR> For each transaction, the corresponding decoder analyzes the application-layer communications and extracts protocol-specific elements.  For example, for an FTP login transaction, the FTP decoder may extract a pattern corresponding to a user
name, a name for the target device, a name for the client device and other information.
<BR><BR> In addition, the decoders may analyze the application-layer communications associated with each transaction to determine whether the communications contain any protocol-specific "anomalies." In general, a protocol anomaly refers to any detected
irregularity within an application-layer communication that does not comply with generally accepted rules of communication for a particular protocol.  The rules may, for example, be defined by published standards as well as vendor-defined specifications. Other anomalies refer to protocol events (i.e., actions) that technically comply with protocol rules but that may warrant a heightened level of scrutiny.  One example of such a protocol event is repeated failure of an FTP login request.  Example
anomalies for the HTTP protocol include missing HTTP version information, malformed universal resource locators (URLs), directory traversals, header overflow, authentication overflow and cookie overflow.  Example anomalies for SMTP protocol include too
many recipients, <B><I>relay</I></B> attempts, and domain names that exceed a defined length.  Example anomalies for the POP3 protocol include user overflow and failed logins.  Example anomalies for the FTP protocol include missing arguments, usernames or pathnames
that exceed a defined length and failed logins.  Other anomalies include abnormal and out-of-specification data transmissions, and commands directing devices to open network connections to devices other than the client devices issuing the commands.
<BR><BR> Typical protocol anomalies often cannot easily be detected with conventional pattern matching as the detection is not based on specific text strings.  Rather, protocol anomaly detection may be based on relationships between two or more elements
of a network protocol and, in particular, determination of whether the relationships conform to the generally accepted rules for that particular protocol.  In some situations, protocol anomaly detection may be used to detect unknown and new attacks based
on the fact that these attacks deviate from generally accepted communication standards.
<BR><BR> IDP device 10 applies attack definitions to the elements or the protocol-specific anomalies identified by the protocol decoders to detect and prevent network attacks.  For example, a system administrator may specify an attack definition that
includes the protocol anomaly of repeated FTP login failure and a pattern that matches a login username of "root." In this manner, the system administrator may combine pattern analysis with protocol anomalies to define complex attack definitions.  In the
event of a network attack, IDP device 10 may take one or more programmed actions, such as automatically dropping packet flows associated with the application-layer communications within which the network attack was detected.
<BR><BR> In accordance with the principles of the invention, IDP device 10 is capable of recognizing and blocking network attacks associated with flows regardless of whether the flows are encapsulated within network tunnels.  In particular, IDP device 10
automatically determines whether received packets are associated with a tunneling protocol and, therefore, includes payloads that encapsulate "data units." In general, the term data unit is used herein to refer to any form of data that may be
encapsulated within a network tunnel.  Examples of data units include packets, frames, cells or other types of data units.  If the packets are associated with a network tunnel, IDP device 10 further analyzes the packets to determine whether the data
units encapsulated within the payload are encrypted.  As further described below, IDP device 10 may apply protocol-specific algorithms to heuristically determine whether the encapsulated data units are encrypted.
<BR><BR> In the event that the encapsulated data units are not encrypted, IDP device 10 constructs temporary packets from the encapsulated data units.  The temporary packets mimic non-tunneled packets and are used internally within IDP device 10.  In
other words, the protocol decoders within IDP device 10 process the temporary packets in a same manner as non-tunneled packets to detect and prevent network attacks.  In this manner, IDP device 10 may detect network attacks carried by data units
encapsulated within network tunnel even though the IDP device may operate as an intermediate device and not as an endpoint device associated with the network tunnel.
<BR><BR> In some embodiments, enterprise network 5 may include multiple IDP devices 10, 12 and 14 located within different regions (e.g., sub-networks) of enterprise network 5.  Security management device 18 may operate as a central device for managing
IDP devices 10, 12 and 14.  Although the example illustrated in FIG. 1 is described in terms of dedicated IDP devices 10, 12 and 14, the functionality described herein may be incorporated within other devices, such as firewall 9 or switch 19.  The
functionality described herein may be incorporated within devices, such as IDP devices 10 and 14, that selectively forward network traffic based on whether an attack is detected.  In other embodiments, the functionality may be incorporated within devices
that passively monitor network traffic.  For example, an <B><I>intrusion detection system</I></B> (IDS) may be coupled to switch 19 to passively monitor network traffic flowing through the switch.
<BR><BR> FIG. 2 is a block diagram illustrating an example embodiment of an IDP device 20.  In the example, IDP device 20 includes a forwarding plane 22 that transparently monitors inbound network traffic 24 and transparently forwards the network traffic
as outbound network traffic 26.  In the example illustrated by FIG. 2, forwarding plane 22 includes filter module 28, flow analysis module 32, flow table 36, attack detection engine 40, protocol decoders 48 and forwarding component 44.
<BR><BR> Filter module 28 receives inbound traffic 24 from a network, such as public network 6 (FIG. 1).  In general, filter module 28 automatically determines whether a received packet is associated with a tunneling protocol and, therefore, includes a
payload that encapsulates a data unit.  If the packet is not associated with a tunneling protocol, filter module 28 passes the non-tunneled packet directly to flow analysis module 32 via packet stream 30.  On the other hand, if the incoming packet is
associated with a tunneling protocol, filter module 28 further analyzes the packets to determine whether the data unit encapsulated within the payload is encrypted.
<BR><BR> If the payload is encrypted, filter module 28 bypasses flow analysis module 32 and attack detection engine 40 by sending the original packet to forwarding component 44 via packet stream 34 for retransmission across the network without further
analysis.
<BR><BR> In the event that the encapsulated data unit is not encrypted, filter module 28 extracts the encapsulated data unit.  In some instances, the original tunneled packet may utilize several layers of encapsulation, and each of these layers might
represent a different protocol that has a unique way of encoding or storing the encapsulated data unit.  Consequently, filter module 28 may apply several protocol-specific iterations to extract the encapsulated data unit.
<BR><BR> Once the unencapsulation process is complete, filter module 28 constructs one or more temporary packets from the encapsulated data unit for processing by flow analysis module 32 and attack detection engine 40.  For example, filter module 28 may
construct TCP or UDP packets, i.e., protocols capable of being processed by flow analysis module 32 and attack detection engine 40.  Filter module 28 passes the temporary packets to flow analysis module 32 via packet stream 30.  In other words, the
temporary packets join packet stream 30 of unencapsulated packets that flows to flow analysis module 32 and attack detection engine 40 for analysis.
<BR><BR> Flow analysis module 32 receives packet stream 30, including the temporary packets, and identifies network flows within the traffic.  Each network flow represents a communication session within the network traffic and is identified by at least a
source address, a destination address and a communication protocol.  Flow analysis module 32 may utilize additional information to specify network flows, including source media access control (MAC) address, destination MAC address, source port and
destination port.
<BR><BR> Flow analysis module 32 maintains data within flow table 36 that describes each active flow present within the network traffic.  Flow analysis module 32 outputs commands 54 that reflect changes to flow table 36.  In particular, flow analysis
module 32 outputs ADD_FLOW, REMOVE_FLOW and UPDATE_FLOW commands as it modifies flow table 36 to reflect the current network flows.  In addition, commands 54 convey network elements associated with each flow, i.e., low-level information such as network
hosts, peers, and ports associated with the network traffic.
<BR><BR> For each network flow, attack detection engine 40 buffers the packets and reassembles the packets to form application-layer communications 46.  Attack detection engine 40 invokes the appropriate one of protocol decoders 48 to analyze the
application-layer communications 46.  Protocol decoders 48 represent a set of one or more protocol-specific software modules.  Each of protocol decoders 48 corresponds to a different communication protocol or service.  Examples of communication protocols
that may be supported by protocol decoders 48 include the HyperText Transfer Protocol (HTTP), the File Transfer Protocol (FTP), the Network News Transfer Protocol (NNTP), the Simple Mail Transfer Protocol (SMTP), Telnet, Domain Name System (DNS), Gopher,
Finger, the Post Office Protocol (POP), the Secure Socket Layer (SSL) protocol, the Lightweight Directory Access Protocol (LDAP), Secure Shell (SSH), Server Message Block (SMB) and other protocols.
<BR><BR> Protocol decoders 48 analyze reassembled application-layer communications 46 and output transaction data 51 that identifies application-layer transactions.  In particular, transaction data 51 indicate when a series of related application-layer
communications between two peer devices starts and ends.
<BR><BR> In addition, protocol decoders 48 analyze application-layer communications 46 and extract protocol-specific elements in the form of text.  As used herein, the term "application-layer elements" refer to protocol-specific text strings obtained at
the application-layer.  In particular, protocol decoders 48 extract protocol-specific "contexts" and "values" from the reassembled application-layer communications.  In general, "contexts" are named elements within a protocol stream that uniquely
identify various types of application-level elements.  The named elements provide an application-level basis for describing a communication session.  Examples of contexts include file names, user names, application names, names of attached documents,
protocol-specific header information, protocol-specific authorization data, form data and other information that describes the communication session.  As a particular example, a context for an HTTP protocol stream may include the name of a server
providing the HTTP service and the name of the type of web browser (e.g., "Internet Explorer") accessing the server.  By reassembling application-layer communications, protocol decoders 48 extract specific contexts (e.g., browser type) and corresponding
values (e.g., "Internet Explorer").  Protocol decoders 48 output application-layer elements 53 to attack detection engine 40 for subsequent analysis.
<BR><BR> In addition, protocol decoders 48 apply protocol-specific algorithms to application-layer communications 46 to identify protocol anomalies within each transaction.  Protocol decoders 48 output protocol anomaly data 55 to attack detection engine
40 for further analysis and use in attack detection.
<BR><BR> Attack detection engine 40 receives transaction data 51, application-layer elements 53 and protocol anomaly data 55 from protocol decoders 48.  Attack detection engine 40 applies attack definitions to transaction data 51, protocol-specific
application-layer elements 53 and anomaly data 55 to detect and prevent network attacks and other security risks.
<BR><BR> Based on the analysis, attack detection engine 40 may output instructions 42 to direct forwarding component 44.  For example, attack detection engine 40 may output instructions directing forwarding component 44 to drop the packets associated
with the communication session, automatically close the communication session or other action.  If no security risk is detected for a given application-layer communication session, attack detection engine 40 directs forwarding component 44 to continue to
forward the packet flows between the peers.  For example, forwarding component 44 may maintain a routing table that stores routes in accordance with a topology of the enterprise network for use in forwarding the packet flows.
<BR><BR> Profiler 52 receives commands 54 that describe the updates to flow table 36 including the network elements associated with the network flows.  In addition, profiler 52 may receive transaction data 51, application-layer elements 53 and protocol
anomaly data 55 from attack detection engine 40.  Profiler 52 correlates the network elements and the application-layer elements within correlation database 56.  In particular, profiler 52 stores the network elements and application-layer elements within
correlation database 56, and builds associations between the application-layer and the network elements.  Correlation database 56 may be a relational database, such as SQL Server from Microsoft Corporation.  Applications 58 allow users, such as
administrator 60, to query correlation database 56 for report generation and analysis.
<BR><BR> Configuration manager 62 presents a user interface by which the administrator 60 configures profiler 52.  For example, administrator 60 may configure profiler 52 to monitor particular subnets internal to enterprise 4 (FIG. 1).  When building
associations within correlation database 56, profiler 52 may group all external source network address into a single external source to reduce storage requirements and aid analysis.
<BR><BR> FIG. 3 illustrates a portion of IDP device 20 (FIG. 2) in further detail.  In particular,
<BR><BR> FIG. 3 illustrates an exemplary set of protocol decoders 48A-48N.  In this example, protocol decoders 48A-48N include HTTP decoder 48A, Telnet decoder 48B, FTP decoder 48C, NNTP decoder 48D, SMTP decoder 48E and SMB decoder 48N.
<BR><BR> As illustrated in FIG. 3, each of protocol decoders 48A-48N analyzes corresponding protocol-specific application-layer communications 46A-46N that have been reassembled by attack detection engine 40.  Based on the analysis, each of protocol
decoders 48A-48N output corresponding transaction data 51A-51N identifying transactions within the communications, application-layer elements 53A-53N describing contexts and values associated with the communications, and protocol anomaly data 55A-55N
that describe any protocol anomalies detected within the communications.
<BR><BR> FIG. 4 is a flowchart illustrating the operation of an IDP device according to the principles of this invention.  For exemplary purposes, the flowchart references example IDP device 20 in FIG. 2.
<BR><BR> Initially, configuration manager 62 receives configuration information from administrator 60 and, in response, configures IDP device 20 to monitor subnets of interest (70).  Once configured, IDP device 20 monitors inbound network traffic 24 and,
in particular, receives network packets (71).
<BR><BR> For each network packet, filter module 28 first determines whether the incoming network packet is associated with a tunneling protocol and, therefore, includes a payload that encapsulates a data unit, e.g., packets, frames, cells or other forms
of data units (72).  If the network packet is not associated with a tunneling protocol, filter module 28 forwards the packet to flow analysis module 32 via packet stream 30 for analysis and attack detection.  In other words, when the network packet is
not associated with a tunneling protocol, the network packet does not include a payload that encapsulates another data unit.  As a result, filter module 28 may forward the network packet directly to flow analysis module 32 and attack detection engine 40
for analysis.
<BR><BR> If, however, the packet is associated with a network tunnel, filter module 28 further analyzes the packet to determine whether the data unit encapsulated within the payload is encrypted (74).  As further described below, filter module 28 may
apply protocol-specific techniques to heuristically determine whether the encapsulated data unit is encrypted.  If the data unit is encrypted, filter module 28 bypasses flow analysis module 32 and sends the original packet to forwarding component 44 via
packet stream 34 without further analysis (76).
<BR><BR> If the encapsulated data unit is not encrypted, filter module 28 constructs a temporary packet from the encapsulated data unit to mimic a non-tunneled packet capable of being processed by flow analysis module 32 and attack detection engine 40
(78).  For example, filter module 28 may extract portions of the encapsulated data unit and construct a TCP or UDP packet that may be analyzed by flow analysis module 32 and attack detection engine 40.  Once filter module 28 has constructed the temporary
packet, the filter module forwards the temporary packet to flow analysis module 32 via packet stream 30 for further analysis.
<BR><BR> At this point, the temporary packets generated by filter module 28 essentially rejoin the stream of unencapsulated packets that flows through flow analysis module 32 and attack detection engine 40 for attack detection and prevention.  In
particular, flow analysis module 32 analyzes the network traffic to identify packet flows and updates flow table 36 to describe each active flow present within the network traffic (80).  Next, attack detection engine 40 buffers and reassembles the
packets to form application-layer communications 46 (82), and invokes the appropriate protocol decoders 48 to analyze the application-layer communications (84).  Protocol decoders 48 analyze reassembled application-layer communications 46 and communicate
transaction data 51, application-layer elements 53 and protocol anomaly data 55 to profiler 52 for recording within correlation database 56.
<BR><BR> In the event an attack is not detected based on analysis of the temporary packets (86), forwarding component 41 forwards the original tunneled packets (76).  However, in the event an attack is detected, attack detection engine 40 may output
instructions directing forwarding component 44 to drop the original tunneled packets from which the temporary packets were generated (88).
<BR><BR> FIG. 5 is a block diagram that illustrates one example embodiment of filter module 28.  In the illustrated embodiment, filter module 28 contains a protocol detector 102, a plurality of protocol-specific encryption detection modules 104, a
plurality of protocol-specific data unit extraction modules 106, and a packet generation module 108.
<BR><BR> Protocol detector 102 receives inbound traffic 24 and scans protocol fields of the incoming packets to determine whether the incoming packets are associated with a tunneling protocol.  Protocol detector 102 passes the non-tunneled packets
directly to flow analysis module 32 via packet stream 30.  On the other hand, if incoming packet 24 is associated with a tunneling protocol, protocol detector 102 further analyzes the packets to determine the type of protocol associated with the data
units that are encapsulated within the packets.
<BR><BR> Based on the protocol, protocol detector 102 passes the packets to one of protocol-specific encryption detection modules 104 to determine whether the data units encapsulated within the packets are encrypted.  As described herein, each of
encryption detection modules 104 may apply a set of protocol-specific heuristics to determine whether the encapsulated data units are encrypted.  If the data units are encrypted, encryption detection modules 104 bypass flow analysis module 32 and send
the original packets to forwarding component 44 via packet stream 34 without further analysis.
<BR><BR> If the encapsulated data units are not encrypted, encryption detection modules 104 forward the original packets to appropriate protocol-specific data unit extraction modules 106.  In general, data unit extraction modules 106 apply
protocol-specific algorithms to extract the encapsulated data units, which may by encapsulated packets, frames, cells or other types of data units.
<BR><BR> Packet generation module 108 constructs temporary packets from the encapsulated data units.  More specifically, packet generation module 108 generates temporary packets for internal use within IDP device 20 and in accordance with a protocol
supported by flow analysis module 32 and attack detection engine 40.  In this manner, the temporary packets mimic non-tunneled packets capable of being processed by flow analysis module 32 and attack detection engine 40.  In one embodiment, each
temporary packet includes a tunnel field that is used to identify the corresponding original packet.  Based on the analysis of the temporary packets by flow analysis module 32 and attack detection engine 40, forwarding component 44 (FIG. 2) either
forwards or discards the original packets referenced by the temporary packets.
<BR><BR> FIGS. 6A and 6B are block diagrams illustrating two exemplary IP packets for Internet Protocol Security (IPsec) tunneling.  In particular, FIG. 6A illustrates an exemplary IPsec packet 130 having a non-encrypted payload.  In contrast, FIG. 6B
illustrates an exemplary IPsec packet 160 having an encrypted payload.
<BR><BR> In general, IPsec allows encapsulation of packets encoded according to one of several different security protocols, such as the Encapsulated Security Payload (ESP).  A protocol field of the IP header 132 specifies the particular protocol used to
encapsulate the payload.  For example, ESP uses IP protocol number 50 and Authentication Header (AH) uses 51.  Only some of the IPsec security protocols call for data encryption.  Alternatively, if the IP packet 130 conforms to IP version 6 (IPv6), a
"next header" field identifies the protocol type.
<BR><BR> In the example of FIG. 6A, IP packet 130 encapsulates an unencrypted ESP packet 134 within its payload 136.  ESP packet 134 retains all the normal parts of an ESP packet.  As illustrated, ESP packet 134 has its own header 138, payload 140, pad
and "next header" block 142 and a trailer 144.  In the context of tunneling, the "next header" block 142 identifies the protocol associated with the encapsulated data within payload 136.  In this example, ESP packet 134 encapsulates a TCP or UDP packet
146 that, in turn, has its own distinct header 148 and payload 150.  As described, IDP device 20 (FIG. 2) constructs a temporary packet from the encapsulated packet 146 that is capable of being seamlessly analyzed with other network traffic.  IDP device
20 may, for example, construct a complete packet that may be processed internally within the IDP device.
<BR><BR> In contrast, FIG. 6B shows another IP packet 160 encapsulating an ESP packet 162 in its payload 164.  The difference, however, is that the ESP payload 168 of ESP packet 162 is encrypted.  As FIG. 6B shows, the "next header" block 142 of FIG. 6A
and other data fields within the encrypted portion are inaccessible.  In this case, IDP device 20 does not generate a temporary packet and forwards IP packet 160 without further processing.
<BR><BR> FIG. 7 is a flowchart illustrating exemplary operation of filter module 28 (FIG. 2) when processing IPSec packets, such as IPSec packets 130, 160 shown in FIGS. 6A and 6B.  Upon receiving a packet associated with the IPSec tunneling protocol,
filter module 28 heuristically determines whether the contained payload is unencrypted (as shown in FIG. 6A) or encrypted (as shown in FIG. 6B).  In particular, filter module 28 attempts to read the "next header" field of the packet encapsulated within
ESP payload (180) and determines whether the field identifies a supported protocol in association with encapsulated packet (182).  For example, a value of 6 or 17 within the "next header" field indicates that ESP payload may be an encapsulated TCP or a
UDP packet, respectively.
<BR><BR> If the value is some other number (NO of 182), then encryption detection module 104 determines that either the payload of the ESP packet is encrypted or that the encapsulated packet does not conform to a supported protocol, e.g., TCP or UDP.  In
either case, filter module 28 ceases processing the IPsec packet, and forwards the IPsec packet in unmodified form to forwarding component 44.
<BR><BR> However, if the next header field indicates a supported protocol (YES of 182), filter module 28 performs another test to confirm that the payload is indeed unencrypted and that the values within the next header field were not random values that
happened to match proper protocol identifiers.  More specifically, filter module 28 further examines the ESP payload as if it were a non-encrypted packet conforming to the protocol specified within the next header field.  In particular, filter module 28
attempts to access a field within the header that indicates a length for the packet (184).  For example, if the protocol identifiers within the next header field indicate the ESP payload is an encapsulated TCP packet, filter module 28 examines the first
two bits of the eighth byte of the ESP payload in an attempt to read a TCP header.  For UDP, filter module 28 attempts to read the seventh and eighth bytes of the ESP payload.
<BR><BR> After filter module 28 has determined the length of encapsulated packet 146 according to the encapsulated header, filter module 28 calculates the actual length of the encapsulated packet (186).  Filter module 28 compares the indicated length to
the actual length (188).  If the length determined from the TCP or UDP header 148 matches the actual length of the data in the ESP payload, then filter module 28 determines that the ESP payload is likely an unencrypted TCP or UDP packet (YES of 188). 
For example, encapsulated packet 146 may be associated with a non-secure (i.e., unencrypted) network tunnel.  As another example, encapsulated packet 146 may form part of an authentication process for a secure network tunnel and, as such, is not
encrypted.  In any case, filter module 28 extracts encapsulated packet 146 and modifies the packet to form a complete, temporary packet that may be forwarded and processed within IDP device 20 (190).
<BR><BR> If the lengths do not match (NO of 188), filter module 28 determines that either the payload is encrypted or the encapsulated packet does not conform to a supported protocol, e.g., TCP or UDP.  In either case, filter module 28 ceases processing
the tunneled packet, and filter module 28 forwards the unmodified (original) packet to forwarding component 44.  In this manner, filter module 28 applies protocol-specific, heuristic techniques to determine whether the payload within a tunneled packet is
encrypted.
<BR><BR> FIG. 8 is a block diagram showing an exemplary temporary packet 202 constructed from an original IPsec packet 200 associated with a network tunnel.  As illustrated, packet 200 represents an IP packet in which the ESP protocol is used to
encapsulate a TCP or UDP packet.
<BR><BR> When constructing temporary packet 202, filter module 28 copies certain fields from original IP header 204 into a new IP header 210.  Filter module 28 then updates fields within new IP header 210, including completing a protocol field with the
protocol identifier read from the "next header" field 212 of the ESP packet.
<BR><BR> Next, filter module 28 extracts TCP or UDP header 220 and payload 216 from payload 208 of the ESP packet, and copies the extracted portions into temporary packet 202.
<BR><BR> Finally, filter module 28 sets a tunnel pointer in new IP header 210 to point to original packet 200, thereby allowing forwarding component 44 to identify the original packet when making forwarding decisions based on the analysis of temporary
packet 200.
<BR><BR> FIGS. 9A and 9B are block diagrams illustrating two examples of packets that conform to the GRE tunneling protocol that may be processed by filter module 28.  In particular, FIG. 9A shows an exemplary IP packet 230 encapsulating a GRE packet
234.  GRE packet 234, in turn, encapsulates another IP packet 238.  FIG. 9B shows an IP packet 240 encapsulating a GRE packet 244.  In this example, GRE packet 244 encapsulates a series of Point-to-Point (PPP) protocol frames 248-252, which may be
complete or partial frames.  In other words, portions of the frames may be in previous or subsequent GRE packets.  Although not illustrated, each of these PPP frames 248-252 has its own frame header and data.
<BR><BR> FIGS. 9A and 9B are shown for exemplary purposes only.  The GRE protocol may be used to encapsulate a large number of other protocols.  In certain applications, the GRE tunneling protocol may be used to encapsulate communications from a wireless
communication network, such as code division multiple access (CDMA) or Global System for Mobile Communication (GSM).
<BR><BR> FIG. 10 is a flowchart illustrating exemplary operation of filter module 28 (FIG. 2) when processing GRE packets, such as GRE packets 230, 240 shown in FIGS. 8A and 8B.
<BR><BR> Upon receiving a packet associated with the GRE tunneling protocol (270), filter module 28 accesses the GRE header to determine the protocol associated with the encapsulated data unit or data units (272).  If the GRE protocol field does not
specify a supported protocol, filter module 28 ceases processing the GRE packet and forwards the GRE packet in unmodified form to forwarding component 44.
<BR><BR> In this example, filter module 28 supports encapsulated GRE packets that encapsulate IP packets and PPP frames.  For example, a value of 0x0080 in the protocol field of the GRE header indicates the GRE packet encapsulates an IP packet.  In this
case, filter module 28 discards the outer IP header and the GRE header and generates a temporary packet from the remaining unencapsulated IP packet (276).  Filter module 28 sets a tunnel field of this temporary packet to a location of original incoming
packet.
<BR><BR> As another example, a value of 0x8881 in the protocol field of the GRE header indicates the GRE packet encapsulates one or more complete or incomplete PPP frames.  In this case, filter module 28 first buffers and reassembles the encapsulated
data to form complete PPP frames so that it can deal with each frame separately (278).  Next, filter module 28 determines the protocol for the data units carried within the PPP frames (280).  For example, each PPP frame typically contains a four or eight
byte header indicating the protocol of the packet contained in that frame.  If the PPP frame does not contain a supported protocol, filtering module 28 ceases processing the GRE packet and forwards the GRE packet in unmodified form to forwarding
component 44.
<BR><BR> In this example, filter device 28 supports PPP frames that carry IP packets or compressed TCP packets.  If the PPP header indicates an IP packet unencapsulation module 106 discards the GRE and PPP frame headers to get the IP packet.
<BR><BR> For compressed TCP packets within the PPP frames, filter module 28 reconstructs the compressed TCP packets based on PPP protocol type, PPP frame information and stored stateful information (282).  For example, Van Jacobson TCP compression is
often used in compressing IP and TCP headers for packets transmitted over PPP links.  The first packet of the TCP session is transmitted in its original form.  Subsequent packets in the session only include a session identifier in the header and the
differences between the current packet and the previous packet headers.  Filter module 28 removes this compression to create temporary packets for processing by flow analysis module 32 and attack detection engine 40.
<BR><BR> If the PPP frame header contains 0x002f in the protocol field, then the PPP frame represents the first packet of a Van Jacobson TCP session.  When filter module 28 sees a frame header with this code, the filter module stores the full TCP and IP
headers in a table.  In this table, filter module 28 indexes packet headers by session identifier.  The table entry exists until the communicating network devices send the signals to terminate the TCP session.
<BR><BR> Subsequent PPP frames of the session having headers with protocol code 0x002d contain Van Jacobson compressed headers.  When filter module 28 sees this code, the filter module checks the Van Jacobson compression header for the session
identifier.  Filter module 28 uses the session identifier to look up the packet header in the Van Jacobson table.  Once filter module 28 retrieves this information, the filter module reconstructs the uncompressed IP and TCP headers.  After retrieving the
header information, filter module 28 updates the table to reflect changes caused by the new header.  In this manner, filter module 28 reconstructs the compressed TCP packets carried by the PPP frames that were encapsulated using the GRE protocol.
<BR><BR> When generating temporary packets, filter module 28 determines whether the PPP frame is the first PPP frame in the GRE packet (284).  If so, filter module 28 creates a temporary packet and sets the temporary packet's tunnel pointer to identify
the original packet (276).  If the current frame was not the first frame in the GRE packet, filter module 28 creates a temporary packet and sets the temporary packet's frame pointer to identify a copy of the original packet (286).
<BR><BR> After processing all complete frames in a GRE packet, filter module 28 updates the buffer to store any remaining incomplete frame and sends the temporary packets to flow analysis module 32 (288).
<BR><BR> Various embodiments of the invention have been described.  Although the embodiments have been described in terms of packet-based systems and specific networking protocols, the techniques may be applied to any network tunneling protocol without
departing from the principles of the invention.  These and other embodiments are within the scope of the following claims.
<BR><BR><CENTER><b>* * * * *</b></CENTER>
<HR>
   <CENTER>
   <a href=http://pdfpiw.uspto.gov/.piw?Docid=08266267&homeurl=http%3A%2F%2Fpatft.uspto.gov%2Fnetacgi%2Fnph-Parser%3FSect1%3DPTO2%2526Sect2%3DHITOFF%2526u%3D%25252Fnetahtml%25252FPTO%25252Fsearch-adv.htm%2526r%3D834%2526f%3DG%2526l%3D50%2526d%3DPTXT%2526s1%3D((G06F.CPCL.%252BAND%252B(%252522intrusion%252Bprevention%252Bsystem%252522%252BOR%252B%252522intrusion%252Bdetection%252Bsystem%252522))%252BAND%252B((power%252BOR%252Belectricity)%252BOR%252Brelay))%2526p%3D17%2526OS%3DCPCL%2FG06F%252BAND%252B(%252522intrusion%252Bprevention%252Bsystem%252522%252BOR%252B%252522intrusion%252Bdetection%252Bsystem%252522)%252BAND%252B(power%252Bor%252Belectricity%252Bor%252Brelay)%2526RS%3D((CPCL%2FG06F%252BAND%252B(%252522intrusion%252Bprevention%252Bsystem%252522%252BOR%252B%252522intrusion%252Bdetection%252Bsystem%252522))%252BAND%252B((power%252BOR%252Belectricity)%252BOR%252Brelay))&PageNum=&Rtype=&SectionNum=&idkey=NONE&Input=View+first+page><img src="/netaicon/PTO/image.gif" alt="[Image]" border="0" valign="middle"></A>
   <TABLE>
   <TR><TD align="center"><A href="https://certifiedcopycenter.uspto.gov/other/patft/view.html?backUrl1=http%3A//patft.uspto.gov/netacgi/nph-Parser?Sect1%3DPTO2%26Sect2%3DHITOFF%26u%3D%25252Fnetahtml%25252FPTO%25252Fsearch-adv.htm%26r%3D834%26f%3DG%26l%3D50%26d%3DPTXT%26s1%3D((G06F.CPCL.%252BAND%252B(%252522intrusion%252Bprevention%252Bsystem%252522%252BOR%252B%252522intrusion%252Bdetection%252Bsystem%252522))%252BAND%252B((power%252BOR%252Belectricity)%252BOR%252Brelay))%26p%3D17%26OS%3DCPCL%2FG06F%252BAND%252B(%252522intrusion%252Bprevention%252Bsystem%252522%252BOR%252B%252522intrusion%252Bdetection%252Bsystem%252522)%252BAND%252B(power%252Bor%252Belectricity%252Bor%252Brelay)&backLabel1=Back%20to%20Document%3A%208266267"><IMG border="0" src="/netaicon/PTO/cart.gif" border="0" valign="m
iddle" alt="[View Shopping Cart]"></A>
   <A href="https://certifiedcopycenter.uspto.gov/other/patft/order.html?docNumber=8266267&backUrl1=http%3A//patft.uspto.gov/netacgi/nph-Parser?Sect1%3DPTO2%26Sect2%3DHITOFF%26u%3D%25252Fnetahtml%25252FPTO%25252Fsearch-adv.htm%26r%3D834%26f%3DG%26l%3D50%26d%3DPTXT%26s1%3D((G06F.CPCL.%252BAND%252B(%252522intrusion%252Bprevention%252Bsystem%252522%252BOR%252B%252522intrusion%252Bdetection%252Bsystem%252522))%252BAND%252B((power%252BOR%252Belectricity)%252BOR%252Brelay))%26p%3D17%26OS%3DCPCL%2FG06F%252BAND%252B(%252522intrusion%252Bprevention%252Bsystem%252522%252BOR%252B%252522intrusion%252Bdetection%252Bsystem%252522)%252BAND%252B(power%252Bor%252Belectricity%252Bor%252Brelay)&backLabel1=Back%20to%20Document%3A%208266267">
   <IMG border="0" src="/netaicon/PTO/order.gif" valign="middle" alt="[Add to Shopping Cart]"></A>
   </TD></TR>
   <TR><TD align="center">
     <A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=834&f=S&l=50&d=PTXT&s1=((G06F.CPCL.+AND+(%22intrusion+prevention+system%22+OR+%22intrusion+detection+system%22))+AND+((power+OR+electricity)+OR+relay))&p=16&Query=CPCL/G06F+AND+(&quot;intrusion+prevention+system&quot;+OR+&quot;intrusion+detection+system&quot;)+AND+(power+or+electricity+or+relay)><IMG VALIGN=MIDDLE SRC=/netaicon/PTO/prevlist.gif border=0 ALT=[PREV_LIST]></A>
<A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=834&f=S&l=50&d=PTXT&s1=((G06F.CPCL.+AND+(%22intrusion+prevention+system%22+OR+%22intrusion+detection+system%22))+AND+((power+OR+electricity)+OR+relay))&p=17&Query=CPCL/G06F+AND+(&quot;intrusion+prevention+system&quot;+OR+&quot;intrusion+detection+system&quot;)+AND+(power+or+electricity+or+relay)><IMG VALIGN=MIDDLE SRC=/netaicon/PTO/hitlist.gif border=0 ALT=[HIT_LIST]></A>
<A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=834&f=S&l=50&d=PTXT&s1=((G06F.CPCL.+AND+(%22intrusion+prevention+system%22+OR+%22intrusion+detection+system%22))+AND+((power+OR+electricity)+OR+relay))&p=18&Query=CPCL/G06F+AND+(&quot;intrusion+prevention+system&quot;+OR+&quot;intrusion+detection+system&quot;)+AND+(power+or+electricity+or+relay)><IMG VALIGN=MIDDLE SRC=/netaicon/PTO/nextlist.gif border=0 ALT=[NEXT_LIST]></A>
<A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=833&f=G&l=50&d=PTXT&s1=((G06F.CPCL.+AND+(%22intrusion+prevention+system%22+OR+%22intrusion+detection+system%22))+AND+((power+OR+electricity)+OR+relay))&p=17&OS=CPCL/G06F+AND+(&quot;intrusion+prevention+system&quot;+OR+&quot;intrusion+detection+system&quot;)+AND+(power+or+electricity+or+relay)><IMG VALIGN=MIDDLE SRC=/netaicon/PTO/prevdoc.gif border=0 ALT=[PREV_DOC]></A>
<A  HREF=/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=835&f=G&l=50&d=PTXT&s1=((G06F.CPCL.+AND+(%22intrusion+prevention+system%22+OR+%22intrusion+detection+system%22))+AND+((power+OR+electricity)+OR+relay))&p=17&OS=CPCL/G06F+AND+(&quot;intrusion+prevention+system&quot;+OR+&quot;intrusion+detection+system&quot;)+AND+(power+or+electricity+or+relay)><IMG VALIGN=MIDDLE SRC=/netaicon/PTO/nextdoc.gif border=0 ALT=[NEXT_DOC]></A>

   <A href="#top"><IMG valign="middle" src="/netaicon/PTO/top.gif" border="0" alt="[Top]"></A>
   </TD></TR>
   </TABLE>
   <A name="bottom"></A>
   <A href="/netahtml/PTO/index.html"><IMG src="/netaicon/PTO/home.gif" alt="[Home]" border="0" valign="middle"></A>
   <A href="/netahtml/PTO/search-bool.html"><IMG src="/netaicon/PTO/boolean.gif" alt="[Boolean Search]" border="0" valign="middle"></A>
   <A href="/netahtml/PTO/search-adv.htm"><IMG border="0" src="/netaicon/PTO/manual.gif" alt="[Manual Search]" valign="middle"></A>
   <A href="/netahtml/PTO/srchnum.htm"><IMG src="/netaicon/PTO/number.gif" alt="[Number Search]" border="0" valign="middle"></A>
   <A href="/netahtml/PTO/help/help.htm"><IMG border="0" src="/netaicon/PTO/help.gif" alt="[Help]" valign="middle"></A>
   </CENTER>
</BODY>
</HTML>